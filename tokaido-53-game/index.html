<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ±æµ·é“äº”åä¸‰æ¬¡ã™ã”ã‚ãã‚²ãƒ¼ãƒ </title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Georgia', serif;
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            min-height: 100vh;
            padding: 20px;
            color: white;
        }

        .game-container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
            color: #333;
        }

        .game-title {
            text-align: center;
            font-size: 2.8em;
            color: #8B0000;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .game-subtitle {
            text-align: center;
            font-size: 1.3em;
            color: #8B4513;
            margin-bottom: 30px;
            font-style: italic;
        }

        .game-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .info-card {
            background: linear-gradient(45deg, #fff8dc, #f0e68c);
            border: 2px solid #DAA520;
            border-radius: 15px;
            padding: 15px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .info-card h3 {
            color: #8B4513;
            font-size: 1.1em;
            margin-bottom: 8px;
        }

        .info-card .value {
            font-size: 1.8em;
            font-weight: bold;
            color: #8B0000;
        }

        .game-board {
            background: linear-gradient(45deg, #f5f5dc, #fffacd);
            border: 3px solid #8B4513;
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 30px;
            position: relative;
        }

        .stations-grid {
            display: grid;
            grid-template-columns: repeat(10, 1fr);
            gap: 8px;
            margin-bottom: 20px;
        }

        .station {
            background: #fff;
            border: 2px solid #ddd;
            border-radius: 12px;
            padding: 8px 4px;
            text-align: center;
            font-size: 0.85em;
            min-height: 60px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            position: relative;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .station:hover {
            background: #fffacd;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .station.current {
            background: linear-gradient(45deg, #FFD700, #FFA500);
            border-color: #FF8C00;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.6);
            transform: scale(1.1);
        }

        .station.visited {
            background: linear-gradient(45deg, #90EE90, #98FB98);
            border-color: #228B22;
        }

        .station.special {
            background: linear-gradient(45deg, #FFB6C1, #FFC0CB);
            border-color: #DC143C;
        }

        .station-number {
            font-size: 0.7em;
            color: #666;
            margin-bottom: 2px;
        }

        .station-name {
            font-weight: bold;
            color: #333;
            font-size: 0.9em;
        }

        .player-token {
            position: absolute;
            top: -8px;
            right: -8px;
            background: #FF4500;
            color: white;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2em;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
            animation: bounce 1s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        .dice-area {
            text-align: center;
            margin: 30px 0;
            padding: 25px;
            background: linear-gradient(45deg, #f0f8ff, #e6f3ff);
            border-radius: 15px;
            border: 2px solid #4169E1;
        }

        .dice {
            font-size: 4em;
            margin: 15px;
            padding: 20px;
            background: white;
            border: 3px solid #333;
            border-radius: 15px;
            display: inline-block;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
        }

        .dice.rolling {
            animation: roll 0.5s ease-in-out;
        }

        @keyframes roll {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(90deg); }
            50% { transform: rotate(180deg); }
            75% { transform: rotate(270deg); }
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 25px;
            font-size: 1.1em;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
        }

        .btn-primary {
            background: linear-gradient(45deg, #8B4513, #A0522D);
            color: white;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .btn-primary:hover {
            background: linear-gradient(45deg, #654321, #8B4513);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }

        .btn-secondary {
            background: linear-gradient(45deg, #DAA520, #FFD700);
            color: #8B4513;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .btn-secondary:hover {
            background: linear-gradient(45deg, #B8860B, #DAA520);
            transform: translateY(-2px);
        }

        .event-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 30px;
            border-radius: 20px;
            border: 4px solid #8B4513;
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.5);
            z-index: 1000;
            max-width: 400px;
            text-align: center;
            display: none;
        }

        .event-popup h3 {
            color: #8B0000;
            margin-bottom: 15px;
            font-size: 1.5em;
        }

        .event-popup p {
            color: #333;
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .progress-bar {
            background: #ddd;
            border-radius: 10px;
            padding: 3px;
            margin: 20px 0;
        }

        .progress-fill {
            background: linear-gradient(45deg, #4CAF50, #8BC34A);
            height: 20px;
            border-radius: 8px;
            transition: width 1s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 0.9em;
            font-weight: bold;
        }

        .rules-section {
            background: linear-gradient(45deg, #f9f5dc, #fff8dc);
            padding: 20px;
            border-radius: 15px;
            margin-top: 20px;
            border-left: 5px solid #8B4513;
        }

        .rules-section h3 {
            color: #8B4513;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .rules-section ul {
            margin-left: 20px;
            color: #654321;
        }

        .rules-section li {
            margin-bottom: 8px;
            line-height: 1.4;
        }

        @media (max-width: 768px) {
            .game-title {
                font-size: 2.2em;
            }
            
            .stations-grid {
                grid-template-columns: repeat(6, 1fr);
                gap: 6px;
            }
            
            .station {
                font-size: 0.75em;
                min-height: 50px;
                padding: 6px 2px;
            }
            
            .controls {
                flex-direction: column;
                align-items: center;
            }
        }
    </style>
</head>
<body>
    <!--
    AI Model: Claude Sonnet 4
    User Prompt: åˆ¥ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œã‚Šã€æ±æµ·é“53æ¬¡ã«é–¢ã™ã‚‹ã‚²ãƒ¼ãƒ ã‚’æ–°ãŸã«ä½œã£ã¦ãã ã•ã„
    AI Approach: æ±æµ·é“äº”åä¸‰æ¬¡ã‚’ãƒ†ãƒ¼ãƒã«ã—ãŸã™ã”ã‚ãå½¢å¼ã®ã‚²ãƒ¼ãƒ ã€‚æ­Œå·åºƒé‡ã®æµ®ä¸–çµµã§æœ‰åãª53ã®å®¿å ´ç”ºã‚’æ±Ÿæˆ¸ã‹ã‚‰äº¬éƒ½ã¾ã§æ—…ã™ã‚‹
    Implementation Intent: æ—¥æœ¬ã®æ­´å²ãƒ»æ–‡åŒ–ã‚’å­¦ã³ãªãŒã‚‰æ¥½ã—ã‚ã‚‹æ•™è‚²çš„ã™ã”ã‚ãã‚²ãƒ¼ãƒ ã€‚å®Ÿéš›ã®å®¿å ´ç”ºãƒ‡ãƒ¼ã‚¿ã¨ç‰¹åˆ¥ã‚¤ãƒ™ãƒ³ãƒˆã§æ±Ÿæˆ¸æ™‚ä»£ã®æ—…è·¯ã‚’ä½“é¨“
    -->

    <div class="game-container">
        <h1 class="game-title">ğŸ® æ±æµ·é“äº”åä¸‰æ¬¡ã™ã”ã‚ã ğŸ®</h1>
        <p class="game-subtitle">æ±Ÿæˆ¸ã‹ã‚‰äº¬éƒ½ã¾ã§53ã®å®¿å ´ç”ºã‚’å·¡ã‚‹å¤§å†’é™ºï¼</p>

        <div class="game-info">
            <div class="info-card">
                <h3>ç¾åœ¨åœ°</h3>
                <div class="value" id="current-station">æ±Ÿæˆ¸ãƒ»æ—¥æœ¬æ©‹</div>
            </div>
            <div class="info-card">
                <h3>å®¿å ´æ•°</h3>
                <div class="value"><span id="station-count">1</span>/55</div>
            </div>
            <div class="info-card">
                <h3>æ‰€æŒé‡‘</h3>
                <div class="value" id="money">1000ä¸¡</div>
            </div>
            <div class="info-card">
                <h3>æ—¥æ•°</h3>
                <div class="value" id="days">0æ—¥</div>
            </div>
        </div>

        <div class="progress-bar">
            <div class="progress-fill" id="progress" style="width: 2%;">
                æ—…è·¯é€²è¡Œåº¦
            </div>
        </div>

        <div class="game-board">
            <div class="stations-grid" id="stations-grid">
                <!-- å®¿å ´ç”ºã¯JavaScriptã§å‹•çš„ç”Ÿæˆ -->
            </div>
        </div>

        <div class="dice-area">
            <div class="dice" id="dice">ğŸ²</div>
            <div style="margin-top: 15px;">
                <button class="btn btn-primary" id="roll-btn" onclick="rollDice()">ğŸ² ã‚µã‚¤ã‚³ãƒ­ã‚’æŒ¯ã‚‹</button>
            </div>
        </div>

        <div class="controls">
            <button class="btn btn-secondary" onclick="showStationInfo()">ğŸ—¾ å®¿å ´æƒ…å ±</button>
            <button class="btn btn-secondary" onclick="showInventory()">ğŸ’ æŒã¡ç‰©</button>
            <button class="btn btn-secondary" onclick="showProgress()">ğŸ“Š é€²è¡ŒçŠ¶æ³</button>
            <button class="btn btn-primary" onclick="resetGame()">ğŸ”„ æ–°ã—ã„æ—…</button>
        </div>

        <div class="rules-section">
            <h3>ğŸ¯ ã‚²ãƒ¼ãƒ ãƒ«ãƒ¼ãƒ«</h3>
            <ul>
                <li>ğŸ² ã‚µã‚¤ã‚³ãƒ­ã‚’æŒ¯ã£ã¦æ±æµ·é“ã‚’é€²ã¿ã¾ã™</li>
                <li>ğŸ¨ å®¿å ´ç”ºã§ã¯ä¼‘æ†©ã‚„è²·ã„ç‰©ãŒã§ãã¾ã™</li>
                <li>ğŸ’° ãŠé‡‘ã‚’ç®¡ç†ã—ãªãŒã‚‰äº¬éƒ½ã‚’ç›®æŒ‡ã—ã¾ã™</li>
                <li>ğŸª ç‰¹åˆ¥ãªå®¿å ´ã§ã¯ã‚¤ãƒ™ãƒ³ãƒˆãŒç™ºç”Ÿã—ã¾ã™</li>
                <li>â›©ï¸ å…¨55åœ°ç‚¹ï¼ˆæ±Ÿæˆ¸ãƒ»å®¿å ´53ãƒ»äº¬éƒ½ï¼‰åˆ¶è¦‡ã§å‹åˆ©ï¼</li>
                <li>ğŸ“š å®Ÿéš›ã®æ­´å²ã¨åœ°ç†ã‚’å­¦ã¹ã‚‹æ•™è‚²ã‚²ãƒ¼ãƒ ã§ã™</li>
            </ul>
        </div>
    </div>

    <!-- ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒƒãƒ—ã‚¢ãƒƒãƒ— -->
    <div class="event-popup" id="event-popup">
        <h3 id="event-title">ã‚¤ãƒ™ãƒ³ãƒˆ</h3>
        <p id="event-description">èª¬æ˜</p>
        <button class="btn btn-primary" onclick="closeEvent()">ç¶šã‘ã‚‹</button>
    </div>

    <script>
        // æ±æµ·é“äº”åä¸‰æ¬¡ãƒ‡ãƒ¼ã‚¿ï¼ˆæ±Ÿæˆ¸ã‹ã‚‰äº¬éƒ½ã¾ã§55åœ°ç‚¹ï¼‰
        const TOKAIDO_STATIONS = [
            { name: "æ±Ÿæˆ¸ãƒ»æ—¥æœ¬æ©‹", description: "æ—…ã®å‡ºç™ºç‚¹", special: true },
            { name: "å“å·å®¿", description: "æ±Ÿæˆ¸å››å®¿ã®ä¸€ã¤", special: false },
            { name: "å·å´å®¿", description: "å¤šæ‘©å·ã®æ¸¡ã—å ´", special: false },
            { name: "ç¥å¥ˆå·å®¿", description: "æ¨ªæµœæ¸¯ã«è¿‘ã„å®¿å ´", special: true },
            { name: "ä¿åœŸãƒ¶è°·å®¿", description: "å‚é“ã®å¤šã„å®¿å ´", special: false },
            { name: "æˆ¸å¡šå®¿", description: "ç®±æ ¹è·¯ã¸ã®åˆ†å²ç‚¹", special: false },
            { name: "è—¤æ²¢å®¿", description: "éŠè¡Œå¯ºã§æœ‰å", special: true },
            { name: "å¹³å¡šå®¿", description: "ä¸ƒå¤•ã¾ã¤ã‚Šã®è¡—", special: false },
            { name: "å¤§ç£¯å®¿", description: "æµ·æ²¿ã„ã®ç¾ã—ã„å®¿å ´", special: false },
            { name: "å°ç”°åŸå®¿", description: "å°ç”°åŸåŸã®åŸä¸‹ç”º", special: true },
            { name: "ç®±æ ¹å®¿", description: "é™ºã—ã„å±±é“ã®å®¿å ´", special: true },
            { name: "ä¸‰å³¶å®¿", description: "ä¼Šè±†å›½ã®ç„é–¢å£", special: false },
            { name: "æ²¼æ´¥å®¿", description: "é§¿æ²³æ¹¾ã«é¢ã—ãŸå®¿å ´", special: false },
            { name: "åŸå®¿", description: "å¯Œå£«å±±ãŒã‚ˆãè¦‹ãˆã‚‹", special: false },
            { name: "å‰åŸå®¿", description: "å¯Œå£«å±±ã®çµ¶æ™¯ã‚¹ãƒãƒƒãƒˆ", special: true },
            { name: "è’²åŸå®¿", description: "é›ªæ™¯è‰²ã§æœ‰å", special: false },
            { name: "ç”±æ¯”å®¿", description: "è–©åŸµå³ ã®é›£æ‰€", special: false },
            { name: "èˆˆæ´¥å®¿", description: "æ¸…è¦‹å¯ºã§æœ‰å", special: false },
            { name: "æ±Ÿå°»å®¿", description: "æ¸…æ°´æ¸¯ã«è¿‘ã„", special: false },
            { name: "åºœä¸­å®¿", description: "é§¿åºœåŸã®åŸä¸‹ç”º", special: true },
            { name: "é å­å®¿", description: "ã¨ã‚ã‚æ±ã§æœ‰å", special: false },
            { name: "å²¡éƒ¨å®¿", description: "å®‡æ´¥ãƒè°·å³ è¶Šãˆ", special: false },
            { name: "è—¤æå®¿", description: "ç”°ä¸­åŸã«è¿‘ã„", special: false },
            { name: "å³¶ç”°å®¿", description: "å¤§äº•å·ã®å·è¶Šã—", special: true },
            { name: "é‡‘è°·å®¿", description: "ç‰§ãƒåŸå°åœ°ã®å…¥å£", special: false },
            { name: "æ—¥å‚å®¿", description: "å°å¤œã®ä¸­å±±è¶Šãˆ", special: false },
            { name: "æ›å·å®¿", description: "æ›å·åŸã®åŸä¸‹ç”º", special: true },
            { name: "è¢‹äº•å®¿", description: "æ±æµ·é“ã®çœŸã‚“ä¸­", special: true },
            { name: "è¦‹ä»˜å®¿", description: "å¤©ç«œå·ã«è¿‘ã„", special: false },
            { name: "æµœæ¾å®¿", description: "æµœæ¾åŸã®åŸä¸‹ç”º", special: true },
            { name: "èˆå‚å®¿", description: "æµœåæ¹–ç•”ã®å®¿å ´", special: false },
            { name: "æ–°å±…å®¿", description: "æ–°å±…é–¢æ‰€ã§æœ‰å", special: true },
            { name: "ç™½é ˆè³€å®¿", description: "æ½®è¦‹å‚ã®çµ¶æ™¯", special: false },
            { name: "äºŒå·å®¿", description: "æœ¬é™£ãŒç¾å­˜", special: false },
            { name: "å‰ç”°å®¿", description: "å‰ç”°åŸã®åŸä¸‹ç”º", special: false },
            { name: "å¾¡æ²¹å®¿", description: "æ¾ä¸¦æœ¨ãŒç¾ã—ã„", special: false },
            { name: "èµ¤å‚å®¿", description: "æ‰ä¸¦æœ¨ã®å®¿å ´", special: false },
            { name: "è—¤å·å®¿", description: "ã‚€ã‚‰ã•ãéº¦ã§æœ‰å", special: false },
            { name: "å²¡å´å®¿", description: "å¾³å·å®¶åº·ç”Ÿèª•ã®åœ°", special: true },
            { name: "æ± é¯‰é®’å®¿", description: "é¦¬å¸‚ã§è³‘ã‚ã†", special: false },
            { name: "é³´æµ·å®¿", description: "æœ‰æ¾çµã‚Šã§æœ‰å", special: false },
            { name: "å®®å®¿", description: "ç†±ç”°ç¥å®®ã®é–€å‰ç”º", special: true },
            { name: "æ¡‘åå®¿", description: "ä¸ƒé‡Œã®æ¸¡ã—", special: true },
            { name: "å››æ—¥å¸‚å®¿", description: "æ¸¯ç”ºã¨ã—ã¦æ „ãˆã‚‹", special: false },
            { name: "çŸ³è–¬å¸«å®¿", description: "è–¬å¸«å¦‚æ¥ã§æœ‰å", special: false },
            { name: "åº„é‡å®¿", description: "ç™½é›¨ã®åæ‰€", special: false },
            { name: "äº€å±±å®¿", description: "äº€å±±åŸã®åŸä¸‹ç”º", special: false },
            { name: "é–¢å®¿", description: "æ±æµ·é“ã®é–¢æ‰€", special: true },
            { name: "å‚ä¸‹å®¿", description: "éˆ´é¹¿å³ ã®éº“", special: false },
            { name: "åœŸå±±å®¿", description: "éˆ´é¹¿å³ è¶Šãˆã®å®¿å ´", special: true },
            { name: "æ°´å£å®¿", description: "æ°´å£åŸã®åŸä¸‹ç”º", special: false },
            { name: "çŸ³éƒ¨å®¿", description: "ç”°æ¥½ã§æœ‰å", special: false },
            { name: "è‰æ´¥å®¿", description: "ä¸­å±±é“ã¨ã®åˆæµç‚¹", special: true },
            { name: "å¤§æ´¥å®¿", description: "çµç¶æ¹–ç•”ã®å®¿å ´", special: true },
            { name: "äº¬éƒ½ãƒ»ä¸‰æ¡å¤§æ©‹", description: "æ—…ã®çµ‚ç€ç‚¹", special: true }
        ];

        // ã‚²ãƒ¼ãƒ çŠ¶æ…‹
        let gameState = {
            currentPosition: 0,
            money: 1000,
            days: 0,
            inventory: ['é“ä¸­æ‰‹å½¢', 'è‰é‹'],
            visitedStations: [0],
            isRolling: false
        };

        // ã‚¤ãƒ™ãƒ³ãƒˆãƒ‡ãƒ¼ã‚¿
        const EVENTS = {
            positive: [
                { title: "å•†äººã¨ã®å‡ºä¼šã„", description: "è¦ªåˆ‡ãªå•†äººã‹ã‚‰100ä¸¡ã‚‚ã‚‰ã„ã¾ã—ãŸï¼", effect: { money: 100 } },
                { title: "è‰¯ã„å¤©æ°—", description: "å¿«æ™´ã§è¶³å–ã‚Šã‚‚è»½ã‚„ã‹ï¼1æ—¥å¾—ã—ã¾ã—ãŸ", effect: { days: -1 } },
                { title: "åç‰©æ–™ç†", description: "ç¾å‘³ã—ã„åç‰©æ–™ç†ã§å…ƒæ°—å›å¾©ï¼", effect: { money: -50, item: "åç‰©æ–™ç†" } },
                { title: "æ—…ä»²é–“", description: "é ¼ã‚‚ã—ã„æ—…ä»²é–“ãŒã§ãã¾ã—ãŸï¼", effect: { item: "æ—…ä»²é–“" } }
            ],
            negative: [
                { title: "ç›—è³Š", description: "ç›—è³Šã«é­ã„ã€200ä¸¡å–ã‚‰ã‚Œã¾ã—ãŸ...", effect: { money: -200 } },
                { title: "æ‚ªå¤©å€™", description: "å¤§é›¨ã§è¶³æ­¢ã‚ã€2æ—¥é…ã‚Œã¾ã—ãŸ", effect: { days: 2 } },
                { title: "ç—…æ°—", description: "é¢¨é‚ªã‚’ã²ã„ã¦è–¬ä»£150ä¸¡", effect: { money: -150 } },
                { title: "é“ã«è¿·ã†", description: "é“ã«è¿·ã£ã¦1æ—¥ä½™è¨ˆã«ã‹ã‹ã‚Šã¾ã—ãŸ", effect: { days: 1 } }
            ]
        };

        // ã‚²ãƒ¼ãƒ åˆæœŸåŒ–
        function initGame() {
            gameState = {
                currentPosition: 0,
                money: 1000,
                days: 0,
                inventory: ['é“ä¸­æ‰‹å½¢', 'è‰é‹'],
                visitedStations: [0],
                isRolling: false
            };
            
            renderStations();
            updateGameInfo();
        }

        // å®¿å ´ç”ºè¡¨ç¤º
        function renderStations() {
            const grid = document.getElementById('stations-grid');
            grid.innerHTML = '';
            
            TOKAIDO_STATIONS.forEach((station, index) => {
                const stationDiv = document.createElement('div');
                stationDiv.className = 'station';
                
                if (index === gameState.currentPosition) {
                    stationDiv.classList.add('current');
                    stationDiv.innerHTML = `<div class="player-token">ğŸš¶</div>`;
                } else if (gameState.visitedStations.includes(index)) {
                    stationDiv.classList.add('visited');
                }
                
                if (station.special) {
                    stationDiv.classList.add('special');
                }
                
                stationDiv.innerHTML += `
                    <div class="station-number">${index + 1}</div>
                    <div class="station-name">${station.name}</div>
                `;
                
                stationDiv.onclick = () => showStationDetail(index);
                grid.appendChild(stationDiv);
            });
        }

        // ã‚µã‚¤ã‚³ãƒ­ã‚’æŒ¯ã‚‹
        function rollDice() {
            if (gameState.isRolling) return;
            
            gameState.isRolling = true;
            const dice = document.getElementById('dice');
            const rollBtn = document.getElementById('roll-btn');
            
            dice.classList.add('rolling');
            rollBtn.disabled = true;
            rollBtn.textContent = 'æŒ¯ã£ã¦ã„ã¾ã™...';
            
            // ã‚µã‚¤ã‚³ãƒ­ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
            let animationCount = 0;
            const animationInterval = setInterval(() => {
                dice.textContent = ['âš€', 'âš', 'âš‚', 'âšƒ', 'âš„', 'âš…'][Math.floor(Math.random() * 6)];
                animationCount++;
                
                if (animationCount > 10) {
                    clearInterval(animationInterval);
                    
                    const result = Math.floor(Math.random() * 6) + 1;
                    dice.textContent = ['âš€', 'âš', 'âš‚', 'âšƒ', 'âš„', 'âš…'][result - 1];
                    
                    setTimeout(() => {
                        movePlayer(result);
                        dice.classList.remove('rolling');
                        rollBtn.disabled = false;
                        rollBtn.textContent = 'ğŸ² ã‚µã‚¤ã‚³ãƒ­ã‚’æŒ¯ã‚‹';
                        gameState.isRolling = false;
                    }, 500);
                }
            }, 100);
        }

        // ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ç§»å‹•
        function movePlayer(steps) {
            const newPosition = Math.min(gameState.currentPosition + steps, TOKAIDO_STATIONS.length - 1);
            
            gameState.currentPosition = newPosition;
            gameState.days += Math.ceil(steps / 2);
            gameState.visitedStations.push(newPosition);
            
            // ç§»å‹•ã‚³ã‚¹ãƒˆ
            gameState.money -= steps * 10;
            
            renderStations();
            updateGameInfo();
            
            // ç‰¹åˆ¥ãªå®¿å ´ã§ã®ã‚¤ãƒ™ãƒ³ãƒˆ
            const currentStation = TOKAIDO_STATIONS[newPosition];
            if (currentStation.special && Math.random() < 0.7) {
                setTimeout(() => {
                    triggerEvent();
                }, 1000);
            }
            
            // å‹åˆ©åˆ¤å®š
            if (newPosition === TOKAIDO_STATIONS.length - 1) {
                setTimeout(() => {
                    showVictory();
                }, 1500);
            }
        }

        // ã‚¤ãƒ™ãƒ³ãƒˆç™ºç”Ÿ
        function triggerEvent() {
            const isPositive = Math.random() < 0.6;
            const events = isPositive ? EVENTS.positive : EVENTS.negative;
            const event = events[Math.floor(Math.random() * events.length)];
            
            // ã‚¤ãƒ™ãƒ³ãƒˆåŠ¹æœé©ç”¨
            if (event.effect.money) {
                gameState.money += event.effect.money;
            }
            if (event.effect.days) {
                gameState.days += event.effect.days;
            }
            if (event.effect.item) {
                gameState.inventory.push(event.effect.item);
            }
            
            showEventPopup(event.title, event.description);
            updateGameInfo();
        }

        // ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—è¡¨ç¤º
        function showEventPopup(title, description) {
            document.getElementById('event-title').textContent = title;
            document.getElementById('event-description').textContent = description;
            document.getElementById('event-popup').style.display = 'block';
        }

        // ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—é–‰ã˜ã‚‹
        function closeEvent() {
            document.getElementById('event-popup').style.display = 'none';
        }

        // ã‚²ãƒ¼ãƒ æƒ…å ±æ›´æ–°
        function updateGameInfo() {
            const currentStation = TOKAIDO_STATIONS[gameState.currentPosition];
            document.getElementById('current-station').textContent = currentStation.name;
            document.getElementById('station-count').textContent = gameState.currentPosition + 1;
            document.getElementById('money').textContent = `${gameState.money}ä¸¡`;
            document.getElementById('days').textContent = `${gameState.days}æ—¥`;
            
            // é€²è¡Œåº¦ãƒãƒ¼æ›´æ–°
            const progress = (gameState.currentPosition / (TOKAIDO_STATIONS.length - 1)) * 100;
            document.getElementById('progress').style.width = `${progress}%`;
        }

        // å®¿å ´è©³ç´°è¡¨ç¤º
        function showStationDetail(index) {
            const station = TOKAIDO_STATIONS[index];
            alert(`${station.name}\n\n${station.description}\n${station.special ? '\nğŸª ç‰¹åˆ¥ãªå®¿å ´ã§ã™' : ''}`);
        }

        // å®¿å ´æƒ…å ±è¡¨ç¤º
        function showStationInfo() {
            const currentStation = TOKAIDO_STATIONS[gameState.currentPosition];
            let info = `ğŸ“ ç¾åœ¨åœ°: ${currentStation.name}\n\n`;
            info += `ğŸ“ èª¬æ˜: ${currentStation.description}\n\n`;
            info += `ğŸ¨ å®¿å ´ã‚¿ã‚¤ãƒ—: ${currentStation.special ? 'ç‰¹åˆ¥ãªå®¿å ´' : 'ä¸€èˆ¬ã®å®¿å ´'}\n\n`;
            info += `ğŸ“Š é€²è¡Œåº¦: ${gameState.currentPosition + 1}/${TOKAIDO_STATIONS.length} (${Math.round((gameState.currentPosition / (TOKAIDO_STATIONS.length - 1)) * 100)}%)`;
            alert(info);
        }

        // æŒã¡ç‰©è¡¨ç¤º
        function showInventory() {
            let inventory = 'ğŸ’ æŒã¡ç‰©:\n\n';
            gameState.inventory.forEach(item => {
                inventory += `â€¢ ${item}\n`;
            });
            inventory += `\nğŸ’° æ‰€æŒé‡‘: ${gameState.money}ä¸¡`;
            alert(inventory);
        }

        // é€²è¡ŒçŠ¶æ³è¡¨ç¤º
        function showProgress() {
            let progress = 'ğŸ“Š æ—…ã®è¨˜éŒ²:\n\n';
            progress += `ğŸš¶ ç¾åœ¨åœ°: ${TOKAIDO_STATIONS[gameState.currentPosition].name}\n`;
            progress += `ğŸ“ è¨ªå•æ¸ˆã¿å®¿å ´æ•°: ${gameState.visitedStations.length}/${TOKAIDO_STATIONS.length}\n`;
            progress += `ğŸ“… æ—…è¡Œæ—¥æ•°: ${gameState.days}æ—¥\n`;
            progress += `ğŸ’° æ‰€æŒé‡‘: ${gameState.money}ä¸¡\n`;
            progress += `ğŸ’ æŒã¡ç‰©: ${gameState.inventory.length}å€‹\n\n`;
            progress += `ğŸ æ®‹ã‚Šè·é›¢: ${TOKAIDO_STATIONS.length - 1 - gameState.currentPosition}å®¿å ´`;
            alert(progress);
        }

        // å‹åˆ©è¡¨ç¤º
        function showVictory() {
            let message = 'ğŸ‰ æ±æµ·é“äº”åä¸‰æ¬¡åˆ¶è¦‡ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼ ğŸ‰\n\n';
            message += `ğŸ“… æ—…è¡ŒæœŸé–“: ${gameState.days}æ—¥\n`;
            message += `ğŸ’° æ®‹ã‚Šæ‰€æŒé‡‘: ${gameState.money}ä¸¡\n`;
            message += `ğŸ’ åé›†ã‚¢ã‚¤ãƒ†ãƒ : ${gameState.inventory.length}å€‹\n\n`;
            
            let rank = '';
            if (gameState.days <= 30 && gameState.money >= 500) {
                rank = 'ğŸ† æ—…ã®é”äºº';
            } else if (gameState.days <= 45 && gameState.money >= 200) {
                rank = 'ğŸ¥‰ ç†Ÿç·´æ—…äºº';
            } else if (gameState.days <= 60) {
                rank = 'ğŸ¥ˆ æ™®é€šã®æ—…äºº';
            } else {
                rank = 'ğŸ¥‡ ã®ã‚“ã³ã‚Šæ—…äºº';
            }
            
            message += `è©•ä¾¡: ${rank}`;
            alert(message);
        }

        // ã‚²ãƒ¼ãƒ ãƒªã‚»ãƒƒãƒˆ
        function resetGame() {
            if (confirm('æ–°ã—ã„æ—…ã‚’å§‹ã‚ã¾ã™ã‹ï¼Ÿ')) {
                initGame();
            }
        }

        // ã‚²ãƒ¼ãƒ é–‹å§‹
        initGame();
    </script>
</body>
</html>