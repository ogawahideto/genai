<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç©¶æ¥µãƒ©ãƒ¼ãƒ¡ãƒ³ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Hiragino Sans', 'Yu Gothic', sans-serif;
            background: linear-gradient(135deg, #ff6b35, #f7931e);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50, #3498db);
            color: white;
            text-align: center;
            padding: 30px;
            position: relative;
        }

        .header::before {
            content: 'ğŸœ';
            font-size: 60px;
            display: block;
            margin-bottom: 10px;
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .subtitle {
            opacity: 0.9;
            font-size: 1.1rem;
        }

        .form-section {
            padding: 40px;
        }

        .section {
            margin-bottom: 40px;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 15px;
            border-left: 5px solid #e74c3c;
        }

        .section-title {
            color: #2c3e50;
            font-size: 1.4rem;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .option-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .option-card {
            background: white;
            border: 2px solid #e0e6ed;
            border-radius: 10px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .option-card:hover {
            border-color: #3498db;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .option-card.selected {
            border-color: #e74c3c;
            background: #fff5f5;
        }

        .option-card input[type="radio"] {
            position: absolute;
            opacity: 0;
        }

        .option-title {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .option-desc {
            font-size: 0.9rem;
            color: #666;
            line-height: 1.4;
        }

        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }

        .checkbox-item {
            background: white;
            border: 2px solid #e0e6ed;
            border-radius: 8px;
            padding: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .checkbox-item:hover {
            border-color: #3498db;
            background: #f0f8ff;
        }

        .checkbox-item.checked {
            border-color: #27ae60;
            background: #f0fff4;
        }

        .checkbox-item input[type="checkbox"] {
            display: none;
        }

        .slider-container {
            margin: 20px 0;
        }

        .slider-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .slider {
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: #e0e6ed;
            outline: none;
            -webkit-appearance: none;
        }

        .slider::-webkit-slider-thumb {
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #e74c3c;
            cursor: pointer;
        }

        .ratio-slider-container {
            margin: 10px 0;
            padding: 10px;
            background: white;
            border-radius: 8px;
            border: 1px solid #e0e6ed;
        }

        .ratio-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
            font-size: 0.9rem;
        }

        .ratio-slider {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: #e0e6ed;
            outline: none;
            -webkit-appearance: none;
        }

        .ratio-slider::-webkit-slider-thumb {
            appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #3498db;
            cursor: pointer;
        }

        .soup-preview {
            margin-top: 15px;
            padding: 15px;
            background: #fff9e6;
            border-radius: 10px;
            border-left: 4px solid #f39c12;
        }

        .soup-preview h5 {
            margin-bottom: 10px;
            color: #e67e22;
        }

        .soup-blend-item {
            display: flex;
            justify-content: space-between;
            padding: 3px 0;
            font-size: 0.9rem;
        }

        .special-options {
            background: #fff9e6;
            border-left-color: #f39c12;
        }

        .order-summary {
            background: #e8f5e8;
            border-left-color: #27ae60;
            margin-top: 30px;
        }

        .summary-content {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-top: 15px;
        }

        .price-display {
            font-size: 1.5rem;
            font-weight: bold;
            color: #e74c3c;
            text-align: center;
            margin: 20px 0;
        }

        .order-button {
            width: 100%;
            padding: 18px;
            font-size: 1.3rem;
            font-weight: bold;
            color: white;
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 20px;
        }

        .order-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(231, 76, 60, 0.4);
        }

        .note-input {
            width: 100%;
            min-height: 80px;
            padding: 15px;
            border: 2px solid #e0e6ed;
            border-radius: 10px;
            font-family: inherit;
            font-size: 1rem;
            resize: vertical;
        }

        .note-input:focus {
            outline: none;
            border-color: #3498db;
        }

        ul {
            list-style-type: none;
            padding-left: 0;
        }
        
        li {
            padding: 5px 0;
            border-bottom: 1px solid #f0f0f0;
        }
        
        li:last-child {
            border-bottom: none;
        }
        
        ul ul {
            padding-left: 20px;
            margin-top: 5px;
        }
        
        ul ul li {
            padding: 2px 0;
            font-size: 0.9em;
            color: #666;
        }

        @media (max-width: 768px) {
            .option-grid {
                grid-template-columns: 1fr;
            }
            
            .checkbox-group {
                grid-template-columns: repeat(2, 1fr);
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .form-section {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ç©¶æ¥µãƒ©ãƒ¼ãƒ¡ãƒ³ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º</h1>
            <p class="subtitle">ã‚ãªãŸã ã‘ã®ã‚ªãƒªã‚¸ãƒŠãƒ«ãƒ©ãƒ¼ãƒ¡ãƒ³ã‚’ä½œã‚ã†</p>
        </div>

        <div class="form-section">
            <!-- ã‚¹ãƒ¼ãƒ—ãƒ™ãƒ¼ã‚¹ -->
            <div class="section">
                <h2 class="section-title">ğŸ² ã‚¹ãƒ¼ãƒ—ãƒ™ãƒ¼ã‚¹</h2>
                <p style="margin-bottom: 15px; color: #666; font-size: 0.9rem;">
                    âœ¨ è¤‡æ•°é¸æŠã§ã‚ªãƒªã‚¸ãƒŠãƒ«ãƒ–ãƒ¬ãƒ³ãƒ‰ã‚¹ãƒ¼ãƒ—ã‚’ä½œã‚Œã¾ã™ï¼
                </p>
                <div class="checkbox-group" id="soup-options">
                    <div class="checkbox-item" data-soup="tonkotsu" data-price="0">
                        <input type="checkbox" id="soup-tonkotsu">
                        <div class="option-title">è±šéª¨</div>
                        <div class="option-desc">æ¿ƒåšã§ã‚¯ãƒªãƒ¼ãƒŸãƒ¼ãªè±šéª¨ã®æ—¨å‘³</div>
                    </div>
                    <div class="checkbox-item" data-soup="shoyu" data-price="0">
                        <input type="checkbox" id="soup-shoyu">
                        <div class="option-title">é†¤æ²¹</div>
                        <div class="option-desc">æ¾„ã‚“ã é†¤æ²¹ã®ä¸Šå“ãªå‘³ã‚ã„</div>
                    </div>
                    <div class="checkbox-item" data-soup="miso" data-price="50">
                        <input type="checkbox" id="soup-miso">
                        <div class="option-title">å‘³å™Œ</div>
                        <div class="option-desc">ã‚³ã‚¯ã®ã‚ã‚‹å‘³å™Œã®æ·±ã„é¢¨å‘³</div>
                    </div>
                    <div class="checkbox-item" data-soup="shio" data-price="0">
                        <input type="checkbox" id="soup-shio">
                        <div class="option-title">å¡©</div>
                        <div class="option-desc">ã•ã£ã±ã‚Šã¨ã—ãŸå¡©å‘³ã®ã‚¹ãƒ¼ãƒ—</div>
                    </div>
                    <div class="checkbox-item" data-soup="tsukemen" data-price="100">
                        <input type="checkbox" id="soup-tsukemen">
                        <div class="option-title">ã¤ã‘éºº</div>
                        <div class="option-desc">æ¿ƒåšãªã¤ã‘ãƒ€ãƒ¬ã§ã„ãŸã ã</div>
                    </div>
                    <div class="checkbox-item" data-soup="tantanmen" data-price="150">
                        <input type="checkbox" id="soup-tantanmen">
                        <div class="option-title">æ‹…ã€…éºº</div>
                        <div class="option-desc">ãƒ”ãƒªè¾›ã”ã¾ã®æ‹…ã€…ã‚¹ãƒ¼ãƒ—</div>
                    </div>
                    <div class="checkbox-item" data-soup="chicken" data-price="80">
                        <input type="checkbox" id="soup-chicken">
                        <div class="option-title">é¶ç™½æ¹¯</div>
                        <div class="option-desc">æ¿ƒåšãªé¶ã®æ—¨å‘³ãŸã£ã·ã‚Š</div>
                    </div>
                    <div class="checkbox-item" data-soup="seafood" data-price="120">
                        <input type="checkbox" id="soup-seafood">
                        <div class="option-title">é­šä»‹</div>
                        <div class="option-desc">æµ·ã®å¹¸ãŒé¦™ã‚‹ä¸Šå“ãªå‘³</div>
                    </div>
                </div>
                
                <!-- ãƒŸãƒƒã‚¯ã‚¹æ™‚ã®æ¯”ç‡èª¿æ•´ -->
                <div id="soup-ratio-section" style="display: none; margin-top: 20px; padding: 15px; background: #f0f8ff; border-radius: 10px;">
                    <h4 style="margin-bottom: 15px; color: #2c3e50;">ğŸ¯ ã‚¹ãƒ¼ãƒ—ã®é…åˆæ¯”ç‡</h4>
                    <div id="soup-ratios"></div>
                </div>
            </div>

            <!-- éººã®ç¨®é¡ãƒ»å¤ªã• -->
            <div class="section">
                <h2 class="section-title">ğŸ éººã®å¤ªã•ãƒ»ç¨®é¡</h2>
                <div class="option-grid" id="noodle-options">
                    <div class="option-card" data-option="hosomen" data-price="0">
                        <input type="radio" name="noodle" value="hosomen" id="noodle-hosomen">
                        <div class="option-title">ç´°éºº</div>
                        <div class="option-desc">ã‚¹ãƒ¼ãƒ—ãŒã‚ˆãçµ¡ã‚€ç´°ã‚ã®éºº</div>
                    </div>
                    <div class="option-card" data-option="futomen" data-price="0">
                        <input type="radio" name="noodle" value="futomen" id="noodle-futomen">
                        <div class="option-title">å¤ªéºº</div>
                        <div class="option-desc">é£Ÿã¹å¿œãˆã®ã‚ã‚‹å¤ªã‚ã®éºº</div>
                    </div>
                    <div class="option-card" data-option="chijiremen" data-price="50">
                        <input type="radio" name="noodle" value="chijiremen" id="noodle-chijiremen">
                        <div class="option-title">ç¸®ã‚Œéºº</div>
                        <div class="option-desc">ã‚¹ãƒ¼ãƒ—ãŒã—ã£ã‹ã‚Šçµ¡ã‚€ç¸®ã‚Œéºº</div>
                    </div>
                    <div class="option-card" data-option="hiyamugi" data-price="100">
                        <input type="radio" name="noodle" value="hiyamugi" id="noodle-hiyamugi">
                        <div class="option-title">ã²ã‚„ã‚€ãéºº</div>
                        <div class="option-desc">ã¤ã‚‹ã¤ã‚‹ã¨ã—ãŸé£Ÿæ„Ÿã®æ¥µç´°éºº</div>
                    </div>
                </div>

                <div class="slider-container">
                    <div class="slider-label">
                        <span>éººã®å›ºã•</span>
                        <span id="hardness-value">æ™®é€š</span>
                    </div>
                    <input type="range" class="slider" id="noodle-hardness" min="1" max="7" value="4">
                </div>
            </div>

            <!-- åŸºæœ¬ãƒˆãƒƒãƒ”ãƒ³ã‚° -->
            <div class="section">
                <h2 class="section-title">ğŸ¥š åŸºæœ¬ãƒˆãƒƒãƒ”ãƒ³ã‚°</h2>
                <div class="checkbox-group" id="basic-toppings">
                    <div class="checkbox-item" data-topping="chashu" data-price="200">
                        <input type="checkbox" id="topping-chashu">
                        <label for="topping-chashu">ãƒãƒ£ãƒ¼ã‚·ãƒ¥ãƒ¼</label>
                    </div>
                    <div class="checkbox-item" data-topping="ajitsuke-tamago" data-price="100">
                        <input type="checkbox" id="topping-ajitsuke-tamago">
                        <label for="topping-ajitsuke-tamago">å‘³ç‰</label>
                    </div>
                    <div class="checkbox-item" data-topping="menma" data-price="80">
                        <input type="checkbox" id="topping-menma">
                        <label for="topping-menma">ãƒ¡ãƒ³ãƒ</label>
                    </div>
                    <div class="checkbox-item" data-topping="nori" data-price="50">
                        <input type="checkbox" id="topping-nori">
                        <label for="topping-nori">æµ·è‹”</label>
                    </div>
                    <div class="checkbox-item" data-topping="negi" data-price="50">
                        <input type="checkbox" id="topping-negi">
                        <label for="topping-negi">ãƒã‚®</label>
                    </div>
                    <div class="checkbox-item" data-topping="moyashi" data-price="50">
                        <input type="checkbox" id="topping-moyashi">
                        <label for="topping-moyashi">ã‚‚ã‚„ã—</label>
                    </div>
                </div>
            </div>

            <!-- ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒˆãƒƒãƒ”ãƒ³ã‚° -->
            <div class="section special-options">
                <h2 class="section-title">â­ ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒˆãƒƒãƒ”ãƒ³ã‚°</h2>
                <div class="checkbox-group" id="premium-toppings">
                    <div class="checkbox-item" data-topping="premium-chashu" data-price="400">
                        <input type="checkbox" id="topping-premium-chashu">
                        <label for="topping-premium-chashu">åšåˆ‡ã‚Šãƒãƒ£ãƒ¼ã‚·ãƒ¥ãƒ¼</label>
                    </div>
                    <div class="checkbox-item" data-topping="kakuni" data-price="350">
                        <input type="checkbox" id="topping-kakuni">
                        <label for="topping-kakuni">è§’ç…®</label>
                    </div>
                    <div class="checkbox-item" data-topping="chicken-chashu" data-price="250">
                        <input type="checkbox" id="topping-chicken-chashu">
                        <label for="topping-chicken-chashu">é¶ãƒãƒ£ãƒ¼ã‚·ãƒ¥ãƒ¼</label>
                    </div>
                    <div class="checkbox-item" data-topping="soft-shell-turtle" data-price="600">
                        <input type="checkbox" id="topping-soft-shell-turtle">
                        <label for="topping-soft-shell-turtle">ã™ã£ã½ã‚“</label>
                    </div>
                    <div class="checkbox-item" data-topping="truffle" data-price="800">
                        <input type="checkbox" id="topping-truffle">
                        <label for="topping-truffle">ãƒˆãƒªãƒ¥ãƒ•</label>
                    </div>
                    <div class="checkbox-item" data-topping="wagyu" data-price="1000">
                        <input type="checkbox" id="topping-wagyu">
                        <label for="topping-wagyu">å’Œç‰›</label>
                    </div>
                </div>
            </div>

            <!-- é‡èœãƒˆãƒƒãƒ”ãƒ³ã‚° -->
            <div class="section">
                <h2 class="section-title">ğŸ¥¬ é‡èœãƒˆãƒƒãƒ”ãƒ³ã‚°</h2>
                <div class="checkbox-group" id="vegetable-toppings">
                    <div class="checkbox-item" data-topping="yasai-mashi" data-price="100">
                        <input type="checkbox" id="topping-yasai-mashi">
                        <label for="topping-yasai-mashi">é‡èœãƒã‚·</label>
                    </div>
                    <div class="checkbox-item" data-topping="corn" data-price="80">
                        <input type="checkbox" id="topping-corn">
                        <label for="topping-corn">ã‚³ãƒ¼ãƒ³</label>
                    </div>
                    <div class="checkbox-item" data-topping="spinach" data-price="70">
                        <input type="checkbox" id="topping-spinach">
                        <label for="topping-spinach">ã»ã†ã‚Œã‚“è‰</label>
                    </div>
                    <div class="checkbox-item" data-topping="cabbage" data-price="60">
                        <input type="checkbox" id="topping-cabbage">
                        <label for="topping-cabbage">ã‚­ãƒ£ãƒ™ãƒ„</label>
                    </div>
                    <div class="checkbox-item" data-topping="wakame" data-price="60">
                        <input type="checkbox" id="topping-wakame">
                        <label for="topping-wakame">ã‚ã‹ã‚</label>
                    </div>
                    <div class="checkbox-item" data-topping="kimchi" data-price="100">
                        <input type="checkbox" id="topping-kimchi">
                        <label for="topping-kimchi">ã‚­ãƒ ãƒ</label>
                    </div>
                </div>
            </div>

            <!-- ç‰¹æ®Šã‚ªãƒ—ã‚·ãƒ§ãƒ³ -->
            <div class="section special-options">
                <h2 class="section-title">ğŸŒ¶ï¸ ç‰¹æ®Šã‚ªãƒ—ã‚·ãƒ§ãƒ³</h2>
                <div class="slider-container">
                    <div class="slider-label">
                        <span>è¾›ã•ãƒ¬ãƒ™ãƒ«</span>
                        <span id="spice-value">æ™®é€š</span>
                    </div>
                    <input type="range" class="slider" id="spice-level" min="0" max="10" value="2">
                </div>
                
                <div class="slider-container">
                    <div class="slider-label">
                        <span>æ²¹ã®é‡</span>
                        <span id="oil-value">æ™®é€š</span>
                    </div>
                    <input type="range" class="slider" id="oil-level" min="0" max="5" value="2">
                </div>

                <div class="checkbox-group" style="margin-top: 20px;">
                    <div class="checkbox-item" data-topping="extra-garlic" data-price="50">
                        <input type="checkbox" id="topping-extra-garlic">
                        <label for="topping-extra-garlic">ãƒ‹ãƒ³ãƒ‹ã‚¯</label>
                    </div>
                    <div class="checkbox-item" data-topping="extra-ginger" data-price="50">
                        <input type="checkbox" id="topping-extra-ginger">
                        <label for="topping-extra-ginger">ç”Ÿå§œ</label>
                    </div>
                    <div class="checkbox-item" data-topping="rayu" data-price="30">
                        <input type="checkbox" id="topping-rayu">
                        <label for="topping-rayu">ãƒ©ãƒ¼æ²¹</label>
                    </div>
                    <div class="checkbox-item" data-topping="black-pepper" data-price="30">
                        <input type="checkbox" id="topping-black-pepper">
                        <label for="topping-black-pepper">é»’èƒ¡æ¤’</label>
                    </div>
                </div>
            </div>

            <!-- ç‰¹åˆ¥ãªè¦æœ› -->
            <div class="section">
                <h2 class="section-title">ğŸ“ ç‰¹åˆ¥ãªè¦æœ›ãƒ»ãƒ¡ãƒ¢</h2>
                <textarea class="note-input" id="special-notes" placeholder="ã‚¢ãƒ¬ãƒ«ã‚®ãƒ¼ã‚„ç‰¹åˆ¥ãªè¦æœ›ãŒã‚ã‚Œã°ã”è¨˜å…¥ãã ã•ã„..."></textarea>
            </div>

            <!-- æ³¨æ–‡ã‚µãƒãƒªãƒ¼ -->
            <div class="section order-summary">
                <h2 class="section-title">ğŸ“‹ ã”æ³¨æ–‡å†…å®¹</h2>
                <div class="summary-content" id="order-summary"></div>
                <div class="price-display">
                    åˆè¨ˆ: Â¥<span id="total-price">800</span>
                </div>
                <button class="order-button" onclick="placeOrder()">ã“ã®å†…å®¹ã§æ³¨æ–‡ã™ã‚‹ ğŸœ</button>
            </div>
        </div>
    </div>

    <script>
        const basePrice = 800;
        let currentOrder = {
            soups: [],
            soupRatios: {},
            noodle: '',
            noodleHardness: 'æ™®é€š',
            toppings: [],
            spiceLevel: 'æ™®é€š',
            oilLevel: 'æ™®é€š',
            specialNotes: ''
        };

        const hardnessLevels = ['ãƒãƒªã‚«ã‚¿', 'ã‚«ã‚¿', 'ã‚„ã‚„ç¡¬', 'æ™®é€š', 'ã‚„ã‚„æŸ”', 'æŸ”ã‚‰ã‹', 'ãƒãƒªã‚„ã‚'];
        const spiceLevels = ['ãªã—', 'å°‘ã—', 'æ™®é€š', 'ä¸­è¾›', 'è¾›å£', 'å¤§è¾›', 'æ¿€è¾›', 'åœ°ç„', 'æ­»ç¥', 'æ‚ªé­”', 'å®‡å®™ç´š'];
        const oilLevels = ['ãªã—', 'å°‘ãªã‚', 'æ™®é€š', 'å¤šã‚', 'ã‚®ãƒˆã‚®ãƒˆ', 'è¶…ã‚®ãƒˆã‚®ãƒˆ'];

        document.addEventListener('DOMContentLoaded', function() {
            // ã‚¹ãƒ¼ãƒ—ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã®ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ
            document.querySelectorAll('#soup-options .checkbox-item').forEach(item => {
                item.addEventListener('click', function() {
                    const checkbox = this.querySelector('input[type="checkbox"]');
                    if (checkbox) {
                        checkbox.checked = !checkbox.checked;
                        updateSoupSelection();
                        updateSelection();
                    }
                });
            });

            // éººã®ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ã®ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ
            document.querySelectorAll('#noodle-options .option-card').forEach(card => {
                card.addEventListener('click', function() {
                    const radio = this.querySelector('input[type="radio"]');
                    if (radio) {
                        radio.checked = true;
                        updateSelection();
                    }
                });
            });

            // ãƒˆãƒƒãƒ”ãƒ³ã‚°ã®ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã®ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ
            document.querySelectorAll('.checkbox-item:not(#soup-options .checkbox-item)').forEach(item => {
                item.addEventListener('click', function() {
                    const checkbox = this.querySelector('input[type="checkbox"]');
                    if (checkbox) {
                        checkbox.checked = !checkbox.checked;
                        updateSelection();
                    }
                });
            });

            // ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ã®ã‚¤ãƒ™ãƒ³ãƒˆ
            document.getElementById('noodle-hardness').addEventListener('input', function() {
                document.getElementById('hardness-value').textContent = hardnessLevels[this.value - 1];
                updateSelection();
            });

            document.getElementById('spice-level').addEventListener('input', function() {
                document.getElementById('spice-value').textContent = spiceLevels[this.value];
                updateSelection();
            });

            document.getElementById('oil-level').addEventListener('input', function() {
                document.getElementById('oil-value').textContent = oilLevels[this.value];
                updateSelection();
            });

            document.getElementById('special-notes').addEventListener('input', updateSelection);

            updateSelection();
        });

        function updateSoupSelection() {
            const selectedSoups = document.querySelectorAll('#soup-options input[type="checkbox"]:checked');
            const ratioSection = document.getElementById('soup-ratio-section');
            const ratiosContainer = document.getElementById('soup-ratios');
            
            if (selectedSoups.length > 1) {
                ratioSection.style.display = 'block';
                ratiosContainer.innerHTML = '';
                
                selectedSoups.forEach((soup) => {
                    const soupName = soup.closest('.checkbox-item').querySelector('.option-title').textContent;
                    const soupId = soup.id.replace('soup-', '');
                    
                    if (!currentOrder.soupRatios[soupId]) {
                        currentOrder.soupRatios[soupId] = Math.round(100 / selectedSoups.length);
                    }
                    
                    const ratioDiv = document.createElement('div');
                    ratioDiv.className = 'ratio-slider-container';
                    ratioDiv.innerHTML = `
                        <div class="ratio-label">
                            <span>${soupName}</span>
                            <span id="ratio-${soupId}-value">${currentOrder.soupRatios[soupId]}%</span>
                        </div>
                        <input type="range" class="ratio-slider" id="ratio-${soupId}" 
                               min="10" max="80" value="${currentOrder.soupRatios[soupId]}">
                    `;
                    ratiosContainer.appendChild(ratioDiv);
                    
                    document.getElementById(`ratio-${soupId}`).addEventListener('input', function() {
                        updateSoupRatio(soupId, this.value);
                    });
                });
                
                updateSoupPreview();
            } else {
                ratioSection.style.display = 'none';
                currentOrder.soupRatios = {};
            }
        }

        function updateSoupRatio(soupId, value) {
            currentOrder.soupRatios[soupId] = parseInt(value);
            document.getElementById(`ratio-${soupId}-value`).textContent = value + '%';
            
            autoAdjustRatios(soupId);
            updateSoupPreview();
            updateSelection();
        }

        function autoAdjustRatios(changedSoupId) {
            const allSoupIds = Object.keys(currentOrder.soupRatios);
            const changedValue = currentOrder.soupRatios[changedSoupId];
            const remainingValue = 100 - changedValue;
            const otherSoups = allSoupIds.filter(id => id !== changedSoupId);
            
            if (otherSoups.length > 0) {
                const equalShare = Math.round(remainingValue / otherSoups.length);
                let totalAssigned = changedValue;
                
                otherSoups.forEach((soupId, index) => {
                    if (index === otherSoups.length - 1) {
                        currentOrder.soupRatios[soupId] = 100 - totalAssigned;
                    } else {
                        currentOrder.soupRatios[soupId] = equalShare;
                        totalAssigned += equalShare;
                    }
                    
                    const slider = document.getElementById(`ratio-${soupId}`);
                    const valueDisplay = document.getElementById(`ratio-${soupId}-value`);
                    if (slider && valueDisplay) {
                        slider.value = currentOrder.soupRatios[soupId];
                        valueDisplay.textContent = currentOrder.soupRatios[soupId] + '%';
                    }
                });
            }
        }

        function updateSoupPreview() {
            const ratiosContainer = document.getElementById('soup-ratios');
            const existingPreview = document.querySelector('.soup-preview');
            if (existingPreview) {
                existingPreview.remove();
            }
            
            const selectedSoups = document.querySelectorAll('#soup-options input[type="checkbox"]:checked');
            if (selectedSoups.length > 1) {
                const previewDiv = document.createElement('div');
                previewDiv.className = 'soup-preview';
                previewDiv.innerHTML = '<h5>ğŸ² ã‚ãªãŸã®ã‚ªãƒªã‚¸ãƒŠãƒ«ãƒ–ãƒ¬ãƒ³ãƒ‰</h5>';
                
                selectedSoups.forEach(soup => {
                    const soupName = soup.closest('.checkbox-item').querySelector('.option-title').textContent;
                    const soupId = soup.id.replace('soup-', '');
                    const ratio = currentOrder.soupRatios[soupId] || 0;
                    const blendItem = document.createElement('div');
                    blendItem.className = 'soup-blend-item';
                    blendItem.innerHTML = `<span>${soupName}</span><span>${ratio}%</span>`;
                    previewDiv.appendChild(blendItem);
                });
                
                ratiosContainer.parentNode.appendChild(previewDiv);
            }
        }

        function updateSelection() {
            // é¸æŠçŠ¶æ…‹ã®è¦–è¦šçš„æ›´æ–°
            document.querySelectorAll('.option-card').forEach(card => {
                const radio = card.querySelector('input[type="radio"]');
                if (radio && radio.checked) {
                    card.classList.add('selected');
                } else {
                    card.classList.remove('selected');
                }
            });

            document.querySelectorAll('.checkbox-item').forEach(item => {
                const checkbox = item.querySelector('input[type="checkbox"]');
                if (checkbox && checkbox.checked) {
                    item.classList.add('checked');
                } else {
                    item.classList.remove('checked');
                }
            });

            updateOrderSummary();
        }

        function updateOrderSummary() {
            let totalPrice = basePrice;
            let summaryHTML = '<h3>ğŸ“ é¸æŠå†…å®¹</h3><ul>';

            // ã‚¹ãƒ¼ãƒ—
            const selectedSoups = document.querySelectorAll('#soup-options input[type="checkbox"]:checked');
            if (selectedSoups.length > 0) {
                let soupNames = [];
                let soupTotalPrice = 0;
                
                selectedSoups.forEach(soup => {
                    const soupCard = soup.closest('.checkbox-item');
                    const soupName = soupCard.querySelector('.option-title').textContent;
                    const soupPrice = parseInt(soupCard.dataset.price);
                    const soupId = soup.id.replace('soup-', '');
                    
                    if (selectedSoups.length > 1 && currentOrder.soupRatios[soupId]) {
                        soupNames.push(`${soupName}(${currentOrder.soupRatios[soupId]}%)`);
                        soupTotalPrice += soupPrice * (currentOrder.soupRatios[soupId] / 100);
                    } else {
                        soupNames.push(soupName);
                        soupTotalPrice += soupPrice;
                    }
                });
                
                const soupDisplay = selectedSoups.length > 1 ? 
                    `${soupNames.join(' + ')} ãƒ–ãƒ¬ãƒ³ãƒ‰` : soupNames[0];
                summaryHTML += `<li><strong>ã‚¹ãƒ¼ãƒ—:</strong> ${soupDisplay} (+Â¥${Math.round(soupTotalPrice)})</li>`;
                totalPrice += Math.round(soupTotalPrice);
                currentOrder.soups = soupNames;
            }

            // éºº
            const selectedNoodle = document.querySelector('input[name="noodle"]:checked');
            if (selectedNoodle) {
                const noodleCard = selectedNoodle.closest('.option-card');
                const noodleName = noodleCard.querySelector('.option-title').textContent;
                const noodlePrice = parseInt(noodleCard.dataset.price);
                const hardness = document.getElementById('hardness-value').textContent;
                summaryHTML += `<li><strong>éºº:</strong> ${noodleName} (${hardness}) (+Â¥${noodlePrice})</li>`;
                totalPrice += noodlePrice;
                currentOrder.noodle = noodleName;
                currentOrder.noodleHardness = hardness;
            }

            // ãƒˆãƒƒãƒ”ãƒ³ã‚°
            const selectedToppings = document.querySelectorAll('.checkbox-item.checked:not(#soup-options .checkbox-item)');
            let toppingsArray = [];
            if (selectedToppings.length > 0) {
                summaryHTML += '<li><strong>ãƒˆãƒƒãƒ”ãƒ³ã‚°:</strong><ul>';
                selectedToppings.forEach(topping => {
                    const toppingName = topping.querySelector('label').textContent;
                    const toppingPrice = parseInt(topping.dataset.price);
                    summaryHTML += `<li>${toppingName} (+Â¥${toppingPrice})</li>`;
                    totalPrice += toppingPrice;
                    toppingsArray.push(toppingName);
                });
                summaryHTML += '</ul></li>';
            }
            currentOrder.toppings = toppingsArray;

            // ç‰¹æ®Šã‚ªãƒ—ã‚·ãƒ§ãƒ³
            const spiceLevel = document.getElementById('spice-value').textContent;
            const oilLevel = document.getElementById('oil-value').textContent;
            summaryHTML += `<li><strong>è¾›ã•:</strong> ${spiceLevel}</li>`;
            summaryHTML += `<li><strong>æ²¹ã®é‡:</strong> ${oilLevel}</li>`;
            currentOrder.spiceLevel = spiceLevel;
            currentOrder.oilLevel = oilLevel;

            // ç‰¹åˆ¥ãªè¦æœ›
            const specialNotes = document.getElementById('special-notes').value.trim();
            if (specialNotes) {
                summaryHTML += `<li><strong>ç‰¹åˆ¥ãªè¦æœ›:</strong> ${specialNotes}</li>`;
                currentOrder.specialNotes = specialNotes;
            }

            summaryHTML += '</ul>';

            document.getElementById('order-summary').innerHTML = summaryHTML;
            document.getElementById('total-price').textContent = totalPrice.toLocaleString();
        }

        function placeOrder() {
            const selectedSoups = document.querySelectorAll('#soup-options input[type="checkbox"]:checked');
            if (selectedSoups.length === 0 || !currentOrder.noodle) {
                alert('ã‚¹ãƒ¼ãƒ—ãƒ™ãƒ¼ã‚¹ã¨éººã®ç¨®é¡ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚');
                return;
            }

            let orderText = 'ğŸœ ã”æ³¨æ–‡ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ï¼\n\n';
            
            if (selectedSoups.length > 1) {
                orderText += `ã‚¹ãƒ¼ãƒ—: ${currentOrder.soups.join(' + ')} ãƒ–ãƒ¬ãƒ³ãƒ‰\n`;
                orderText += 'é…åˆæ¯”ç‡:\n';
                selectedSoups.forEach(soup => {
                    const soupName = soup.closest('.checkbox-item').querySelector('.option-title').textContent;
                    const soupId = soup.id.replace('soup-', '');
                    if (currentOrder.soupRatios[soupId]) {
                        orderText += `  â€¢ ${soupName}: ${currentOrder.soupRatios[soupId]}%\n`;
                    }
                });
            } else {
                orderText += `ã‚¹ãƒ¼ãƒ—: ${currentOrder.soups[0]}\n`;
            }
            
            orderText += `éºº: ${currentOrder.noodle} (${currentOrder.noodleHardness})\n`;
            orderText += `è¾›ã•: ${currentOrder.spiceLevel}\n`;
            orderText += `æ²¹ã®é‡: ${currentOrder.oilLevel}\n`;
            
            if (currentOrder.toppings.length > 0) {
                orderText += `ãƒˆãƒƒãƒ”ãƒ³ã‚°: ${currentOrder.toppings.join(', ')}\n`;
            }
            
            if (currentOrder.specialNotes) {
                orderText += `ç‰¹åˆ¥ãªè¦æœ›: ${currentOrder.specialNotes}\n`;
            }
            
            orderText += `\nåˆè¨ˆé‡‘é¡: Â¥${document.getElementById('total-price').textContent}\n\n`;
            
            if (selectedSoups.length > 1) {
                orderText += 'ğŸ¨ ã‚ªãƒªã‚¸ãƒŠãƒ«ãƒ–ãƒ¬ãƒ³ãƒ‰ã®èª¿ç†ã«ã¯å°‘ã—æ™‚é–“ãŒã‹ã‹ã‚Šã¾ã™ã€‚\n';
                orderText += 'èª¿ç†æ™‚é–“ã¯ç´„15-20åˆ†ã§ã™ã€‚ãŠå¾…ã¡ãã ã•ã„ï¼';
            } else {
                orderText += 'èª¿ç†æ™‚é–“ã¯ç´„10-15åˆ†ã§ã™ã€‚ãŠå¾…ã¡ãã ã•ã„ï¼';
            }

            alert(orderText);
        }
    </script>
</body>
</html>