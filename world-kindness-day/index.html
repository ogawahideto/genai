<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ä¸–ç•Œè¦ªåˆ‡ãƒ‡ãƒ¼ï¼ˆ11æœˆ13æ—¥ï¼‰Kindness App</title>
  <meta name="description" content="11æœˆ13æ—¥ãƒ»ä¸–ç•Œè¦ªåˆ‡ãƒ‡ãƒ¼ã«ã¡ãªã‚“ã ã€å°ã•ãªè¦ªåˆ‡ã‚’å®Ÿè·µã™ã‚‹ãŸã‚ã®ã‚¢ã‚¤ãƒ‡ã‚¢ã¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä½œæˆãƒ„ãƒ¼ãƒ«ã€‚">
  <style>
    :root {
      --bg: #0f172a;
      --card: #111827;
      --muted: #9ca3af;
      --text: #e5e7eb;
      --accent: #22c55e;
      --accent-2: #60a5fa;
      --warning: #f59e0b;
      --ring: rgba(96, 165, 250, 0.35);
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Hiragino Kaku Gothic ProN", Meiryo, "Noto Sans JP", sans-serif;
      background: radial-gradient(1200px 600px at 10% -10%, #1f2937 10%, transparent 60%),
                  radial-gradient(1000px 600px at 110% 10%, #0b1222 10%, transparent 60%),
                  var(--bg);
      color: var(--text);
      line-height: 1.6;
    }
    .container {
      max-width: 920px;
      margin: 0 auto;
      padding: 24px 16px 80px;
    }
    header {
      display: grid;
      gap: 8px;
      margin-bottom: 20px;
    }
    h1 {
      margin: 0;
      font-size: clamp(22px, 3.6vw, 32px);
      letter-spacing: 0.3px;
    }
    .subtle { color: var(--muted); font-size: 14px; }
    .hero {
      display: grid;
      gap: 16px;
      background: linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02));
      border: 1px solid rgba(148,163,184,0.15);
      border-radius: 14px;
      padding: 18px 16px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.25), inset 0 1px 0 rgba(255,255,255,0.04);
    }
    .grid {
      display: grid;
      gap: 16px;
      grid-template-columns: 1fr;
    }
    @media (min-width: 820px) {
      .grid { grid-template-columns: 1fr 1fr; }
    }
    .card {
      background: var(--card);
      border: 1px solid rgba(148,163,184,0.15);
      border-radius: 14px;
      padding: 16px;
      box-shadow: 0 6px 20px rgba(0,0,0,0.25), inset 0 1px 0 rgba(255,255,255,0.04);
    }
    h2 { font-size: 18px; margin: 0 0 8px; }
    .tip {
      font-size: 18px;
      margin: 8px 0 14px;
      padding: 12px 12px;
      background: rgba(34,197,94,0.08);
      border: 1px dashed rgba(34,197,94,0.35);
      border-radius: 10px;
    }
    .row { display: flex; gap: 8px; flex-wrap: wrap; align-items: center; }
    .spacer { flex: 1; }
    .count { font-variant-numeric: tabular-nums; }
    button, select, input, textarea {
      font: inherit;
      color: var(--text);
      background: #0b1220;
      border: 1px solid rgba(148,163,184,0.2);
      border-radius: 10px;
      padding: 10px 12px;
      outline: none;
    }
    button {
      cursor: pointer;
      background: linear-gradient(180deg, rgba(96,165,250,0.25), rgba(96,165,250,0.12));
      border-color: rgba(96,165,250,0.5);
    }
    button.primary { background: linear-gradient(180deg, rgba(34,197,94,0.35), rgba(34,197,94,0.18)); border-color: rgba(34,197,94,0.6); }
    button.warn { background: linear-gradient(180deg, rgba(245,158,11,0.35), rgba(245,158,11,0.18)); border-color: rgba(245,158,11,0.6); }
    button:focus, select:focus, input:focus, textarea:focus { box-shadow: 0 0 0 4px var(--ring); }
    textarea { width: 100%; min-height: 110px; resize: vertical; }
    small.hint { color: var(--muted); font-size: 12px; }
    footer { margin-top: 24px; color: var(--muted); font-size: 13px; }
    canvas#confetti { position: fixed; inset: 0; pointer-events: none; z-index: 10; }
    .badge { display: inline-block; padding: 2px 8px; border-radius: 999px; background: rgba(96,165,250,0.15); border: 1px solid rgba(96,165,250,0.4); font-size: 12px; }
  </style>
  <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Cpath fill='%2322c55e' d='M50 80C20 60 10 40 20 30s25-5 30 8c5-13 20-18 30-8s0 30-30 50z'/%3E%3C/svg%3E">
  <meta name="color-scheme" content="dark">
  <meta name="theme-color" content="#0f172a">
  <!-- No external dependencies; works on GitHub Pages under /genai/world-kindness-day/ -->
  <!-- 11æœˆ13æ—¥ã¯ä¸–ç•Œè¦ªåˆ‡ãƒ‡ãƒ¼ï¼ˆWorld Kindness Dayï¼‰ã§ã™ã€‚1998å¹´ã«World Kindness Movementã«ã‚ˆã‚Šæå”±ã€‚ -->
  <!-- Single-file micro-app by guidelines: inline HTML/CSS/JS; no global leaks. -->
  <base href="./">
  <meta property="og:title" content="ä¸–ç•Œè¦ªåˆ‡ãƒ‡ãƒ¼ï¼ˆ11æœˆ13æ—¥ï¼‰Kindness App">
  <meta property="og:description" content="å°ã•ãªè¦ªåˆ‡ã‚’å®Ÿè·µã™ã‚‹ãŸã‚ã®ã‚¢ã‚¤ãƒ‡ã‚¢ã¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç”Ÿæˆã€‚">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://ogawahideto.github.io/genai/world-kindness-day/">
  <meta property="og:image" content="data:image/png;base64,iVBORw0KGgo=">
</head>
<body>
  <canvas id="confetti"></canvas>
  <div class="container">
    <header>
      <div class="badge">11æœˆ13æ—¥ Â· ä¸–ç•Œè¦ªåˆ‡ãƒ‡ãƒ¼</div>
      <h1>ä»Šæ—¥ã®å°ã•ãªè¦ªåˆ‡ã‚’ã€ã²ã¨ã¤ã€‚</h1>
      <div class="subtle">World Kindness Day ã«ã¡ãªã‚“ã ã€è»½ã‚„ã‹ãªå®Ÿè·µã‚¢ãƒ—ãƒª</div>
    </header>

    <section class="hero">
      <div>
        <strong>ä¸–ç•Œè¦ªåˆ‡ãƒ‡ãƒ¼ã¨ã¯ï¼Ÿ</strong><br>
        1998å¹´ã«<strong>World Kindness Movement</strong>ãŒæå”±ã—ãŸã€æ€ã„ã‚„ã‚Šã¨è¦ªåˆ‡ã‚’åºƒã’ã‚‹å›½éš›çš„ãªè¨˜å¿µæ—¥ã§ã™ã€‚<br>
        ã€Œè¦‹è¿”ã‚Šã‚’æ±‚ã‚ãªã„å°ã•ãªè¦ªåˆ‡ã€ã‚’ã€ä»Šæ—¥ã‹ã‚‰æ°—è»½ã«å§‹ã‚ã¦ã¿ã¾ã—ã‚‡ã†ã€‚
      </div>
      <div class="row">
        <small class="hint">ãƒ’ãƒ³ãƒˆ: 1æ—¥1ã¤ã§OKã€‚ç¶šã‘ã‚Œã°ç¿’æ…£ã«ãªã‚Šã¾ã™ã€‚</small>
      </div>
    </section>

    <div class="grid" style="margin-top:16px;">
      <!-- å·¦ï¼šã‚¢ã‚¤ãƒ‡ã‚¢ã¨ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ -->
      <section class="card" aria-labelledby="ideas-title">
        <h2 id="ideas-title">è¦ªåˆ‡ã‚¢ã‚¤ãƒ‡ã‚¢</h2>
        <div id="tip" class="tip" role="status" aria-live="polite">èª­ã¿è¾¼ã¿ä¸­...</div>
        <div class="row">
          <button id="another" type="button">åˆ¥ã®ã‚¢ã‚¤ãƒ‡ã‚¢</button>
          <button id="done" class="primary" type="button">å®Œäº†ï¼</button>
          <span class="spacer"></span>
          <span>ä»Šæ—¥ã®ã‚«ã‚¦ãƒ³ãƒˆ: <strong class="count" id="count">0</strong></span>
        </div>
        <div class="row" style="margin-top:8px;">
          <button id="reset" class="warn" type="button" title="ä»Šæ—¥ã®ã‚«ã‚¦ãƒ³ãƒˆã‚’ãƒªã‚»ãƒƒãƒˆ">ãƒªã‚»ãƒƒãƒˆ</button>
          <small class="hint">ã‚«ã‚¦ãƒ³ãƒˆã¯ç«¯æœ«ã«ã®ã¿ä¿å­˜ï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ï¼‰ã€‚</small>
        </div>
      </section>

      <!-- å³ï¼šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ¡ãƒ¼ã‚«ãƒ¼ -->
      <section class="card" aria-labelledby="msg-title">
        <h2 id="msg-title">ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ¡ãƒ¼ã‚«ãƒ¼</h2>
        <div class="row">
          <label>
            å®›å…ˆ
            <select id="to">
              <option value="åŒåƒš">åŒåƒš</option>
              <option value="å‹ã ã¡">å‹ã ã¡</option>
              <option value="å®¶æ—">å®¶æ—</option>
              <option value="è‡ªåˆ†">è‡ªåˆ†</option>
              <option value="ã”è¿‘æ‰€ã•ã‚“">ã”è¿‘æ‰€ã•ã‚“</option>
            </select>
          </label>
          <label>
            ãƒˆãƒ¼ãƒ³
            <select id="tone">
              <option value="light">ãƒ©ã‚¤ãƒˆ</option>
              <option value="thanks">æ„Ÿè¬</option>
              <option value="cheer">å¿œæ´</option>
            </select>
          </label>
          <label class="spacer">
            ç›¸æ‰‹ã®åå‰ï¼ˆä»»æ„ï¼‰
            <input id="name" type="text" placeholder="ä¾‹: ã•ã¨ã—ã•ã‚“">
          </label>
        </div>
        <div style="margin-top:10px;">
          <textarea id="message" aria-label="ç”Ÿæˆã•ã‚ŒãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸" placeholder="ã“ã“ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã¾ã™"></textarea>
        </div>
        <div class="row" style="margin-top:8px;">
          <button id="gen" type="button">ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä½œã‚‹</button>
          <button id="copy" type="button">ã‚³ãƒ”ãƒ¼</button>
          <button id="share" type="button">å…±æœ‰</button>
          <span class="spacer"></span>
          <small class="hint">å…±æœ‰ã¯å¯¾å¿œç«¯æœ«ã®ã¿</small>
        </div>
      </section>
    </div>

    <footer>
      ã“ã®ãƒšãƒ¼ã‚¸ã¯ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã§ã‚‚å‹•ä½œã—ã¾ã™ã€‚å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ãƒ»ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã¯ä½¿ç”¨ã—ã¦ã„ã¾ã›ã‚“ã€‚<br>
      ææ¡ˆã¯ã‚ãã¾ã§ä¾‹ã§ã™ã€‚ã‚ãªãŸãªã‚Šã®ã€Œå°ã•ãªè¦ªåˆ‡ã€ã‚’è¦‹ã¤ã‘ã¦ãã ã•ã„ã€‚
    </footer>
  </div>

  <script>
    (() => {
      'use strict';

      // ----- Data -----
      const TIPS = [
        'ã‚¨ãƒ¬ãƒ™ãƒ¼ã‚¿ãƒ¼ã§ã€Œã©ã†ãã€ã¨å…ˆã«è­²ã‚‹',
        'ãƒ‰ã‚¢ã‚’é–‹ã‘ã¦å¾Œã‚ã®äººã‚’å¾…ã¤',
        'ã‚ã‚ŠãŒã¨ã†ã‚’ä¸€è¨€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã§ä¼ãˆã‚‹',
        'ä»Šæ—¥å‡ºä¼šã£ãŸäººã®è‰¯ã„ã¨ã“ã‚ã‚’1ã¤è¤’ã‚ã‚‹',
        'å¸­ã‚’ã‚†ãšã‚‹ï¼ç«‹ã¡æ­¢ã¾ã£ã¦é“ã‚’ã‚†ãšã‚‹',
        'è½ã¡ã¦ã„ã‚‹ã‚´ãƒŸã‚’1ã¤æ‹¾ã£ã¦æ¨ã¦ã‚‹',
        'ä¼šè­°ã®å‰å¾Œã«æœºã‚’ã•ã£ã¨æ‹­ã',
        'è¡Œåˆ—ã§ç„¦ã‚‰ãšã«å„ªã—ãä¸¦ã¶',
        'ã‚³ãƒ³ãƒ“ãƒ‹ã§å‹Ÿé‡‘ç®±ã«å°‘é¡å¯„ä»˜ã™ã‚‹',
        'SNSã§èª°ã‹ã®è‰¯ã„æŠ•ç¨¿ã«æ¸©ã‹ã„ã‚³ãƒ¡ãƒ³ãƒˆã‚’æ®‹ã™',
        'åŒåƒšã®ã‚¿ã‚¹ã‚¯ã‚’ã²ã¨ã¤æ‰‹ä¼ã†ã¨ç”³ã—å‡ºã‚‹',
        'é™ã‹ãªå£°ã§è©±ã™ãƒ»å‘¨ã‚Šã«é…æ…®ã™ã‚‹',
        'é“ã«è¿·ã£ã¦ã„ã‚‹äººã«å£°ã‚’ã‹ã‘ã‚‹',
        'ãƒã‚¹ã‚„é›»è»Šã§ãƒ™ãƒ“ãƒ¼ã‚«ãƒ¼ã«ã•ã£ã¨é“ã‚’ä½œã‚‹',
        'ãƒ¬ã‚¸ã§ä¸å¯§ã«ã€ŒãŠé¡˜ã„ã—ã¾ã™ã€ã€Œã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€ã‚’è¨€ã†',
        'è·å ´ã®å…±æœ‰ã‚¹ãƒšãƒ¼ã‚¹ã‚’1åˆ†ã ã‘ç‰‡ä»˜ã‘ã‚‹',
        'å®¶æ—ã«æ„Ÿè¬ã®ãƒ¡ãƒ¢ã‚’æ®‹ã™',
        'è‡ªåˆ†ã«å„ªã—ãã€5åˆ†ä¼‘æ†©ã‚’ãƒ—ãƒ¬ã‚¼ãƒ³ãƒˆã™ã‚‹',
        'è¿‘æ‰€ã®äººã«å…ƒæ°—ãªã‚ã„ã•ã¤ã‚’ã™ã‚‹',
        'ä¿¡å·å¾…ã¡ã§æ·±å‘¼å¸ã—ã¦å‘¨å›²ã«ç©ã‚„ã‹ã•ã‚’åºƒã’ã‚‹',
        'ä»Šæ—¥é–¢ã‚ã£ãŸäººã«ã€ŒåŠ©ã‹ã‚Šã¾ã—ãŸã€ã‚’ä¼ãˆã‚‹',
        'é‡ãã†ãªè·ç‰©ã‚’æŒã¤äººã«æ‰‹ã‚’å·®ã—ä¼¸ã¹ã‚‹',
        'å›³æ›¸ã®è¿”å´æ—¥ã‚’å®ˆã£ã¦æ¬¡ã®äººã¸ãƒãƒˆãƒ³ã‚’æ¸¡ã™',
        'å…¬å…±ã®å ´ã§é“ã‚’ãµã•ãŒãªã„ã‚ˆã†æ„è­˜ã™ã‚‹',
        'ãƒ¡ãƒ¼ãƒ«ã®æ–‡æœ«ã«æ¸©ã‹ã„ä¸€è¨€ã‚’æ·»ãˆã‚‹',
        'ã„ã¤ã‚‚ã‚ˆã‚Š5åˆ†æ—©ãå‡ºã¦å¿ƒã«ä½™è£•ã‚’ä½œã‚‹',
        'ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ä»²é–“ã®PRã«å‰å‘ããªãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’æ®‹ã™',
        'è‰¯ã„ä»•äº‹ã‚’è¦‹ã¤ã‘ãŸã‚‰ãã®å ´ã§ç§°ãˆã‚‹',
        'å°ã•ãªæ‰‹ç´™ã§ã€ŒãŠã¤ã‹ã‚Œã•ã¾ã€ã‚’ä¼ãˆã‚‹',
        'è‡ªåˆ†ã®ãƒŸã‚¹ã«æ­£ç›´ã«ãªã‚Šã€ãƒ•ã‚©ãƒ­ãƒ¼ã™ã‚‹',
        'èª°ã‹ã®è©±ã‚’é®ã‚‰ãšæœ€å¾Œã¾ã§è´ã',
        'ä¸¦ã‚“ã§ã„ã‚‹åˆ—ã«å‰²ã‚Šè¾¼ã¾ãªã„ã‚ˆã†æ³¨æ„ã‚’æ‰•ã†',
        'ç¤¾å†…ã®ãƒŠãƒ¬ãƒƒã‚¸ã‚’1ã¤æ®‹ã™',
        'é“ç«¯ã®æ¤æ ½ã‚’è¸ã¾ãªã„ã‚ˆã†æ°—ã‚’ã¤ã‘ã‚‹',
        'è¿”å´ãƒˆãƒ¬ã‚¤ã«é£Ÿå™¨ã‚’æˆ»ã™',
        'ä¼šè­°ã®æ™‚é–“ã‚’å®ˆã‚‹ï¼ˆæ™‚é–“ã‚‚æ€ã„ã‚„ã‚Šï¼‰',
        'ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ä¼šè­°ã§ç›¸æ‰‹ã®ç™ºè¨€ã‚’ãƒªãƒ•ãƒ¬ãƒ¼ã‚ºã—ã¦ç¢ºèªã™ã‚‹',
        'å…±æœ‰ã®å†·è”µåº«ã‚’1å€‹åˆ†ç‰‡ä»˜ã‘ã‚‹',
        'é§è¼ªãƒ»é§è»Šã¯ãƒ©ã‚¤ãƒ³å†…ã«ä¸å¯§ã«åœã‚ã‚‹'
      ];

      const TEMPLATES = {
        light: [
          '%%name%%ã€ã„ã¤ã‚‚ã‚ã‚ŠãŒã¨ã†ã€‚ã‚ãªãŸã®å„ªã—ã•ã«ä½•åº¦ã‚‚åŠ©ã‘ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚',
          'ã•ã•ã‚„ã‹ã§ã™ãŒæ„Ÿè¬ã‚’å±Šã‘ãŸãã¦ã€‚ä»Šæ—¥ã‚‚ã‚ˆã„ä¸€æ—¥ã‚’ï¼',
          'ãµã¨ä¼ãˆãŸããªã‚Šã¾ã—ãŸã€‚ã‚ãªãŸã®å­˜åœ¨ãŒå‘¨ã‚Šã‚’æ˜ã‚‹ãã—ã¦ã„ã¾ã™ã€‚'
        ],
        thanks: [
          '%%name%%ã€ã“ã®å‰ã®ã‚µãƒãƒ¼ãƒˆæœ¬å½“ã«åŠ©ã‹ã‚Šã¾ã—ãŸã€‚å¿ƒã‹ã‚‰æ„Ÿè¬ã—ã¦ã„ã¾ã™ã€‚',
          'æ—¥é ƒã®æ°—é…ã‚Šã«ã‚ã‚ŠãŒã¨ã†ã€‚ã‚ãªãŸã®ãŠã‹ã’ã§é€²ã‚“ã§ã„ã¾ã™ã€‚',
          'ä¸å¯§ãªãŠä»•äº‹ã«ã„ã¤ã‚‚æ„Ÿè¬ã—ã¦ã„ã¾ã™ã€‚ç„¡ç†ã›ãšã„ãã¾ã—ã‚‡ã†ã€‚'
        ],
        cheer: [
          '%%name%%ã€æœ€è¿‘ã‚ˆãé ‘å¼µã£ã¦ã„ã¾ã™ã­ã€‚ã‚ãªãŸãªã‚‰ãã£ã¨ã§ãã¾ã™ï¼',
          'ã‚†ã£ãã‚Šæ·±å‘¼å¸ã€‚å‘³æ–¹ã¯ã“ã“ã«ã„ã¾ã™ã€‚å¿œæ´ã—ã¦ã„ã¾ã™ã€‚',
          'å°ã•ãªä¸€æ­©ã§ååˆ†ã€‚ç¶šã‘ã‚‹ã‚ãªãŸã‚’å°Šæ•¬ã—ã¦ã„ã¾ã™ã€‚'
        ]
      };

      // ----- Elements -----
      const elTip = document.getElementById('tip');
      const elCount = document.getElementById('count');
      const elAnother = document.getElementById('another');
      const elDone = document.getElementById('done');
      const elReset = document.getElementById('reset');
      const elTo = document.getElementById('to');
      const elTone = document.getElementById('tone');
      const elName = document.getElementById('name');
      const elMsg = document.getElementById('message');
      const elGen = document.getElementById('gen');
      const elCopy = document.getElementById('copy');
      const elShare = document.getElementById('share');

      // ----- State & Storage -----
      const KEY = {
        count: 'wkd:count',
        lastTip: 'wkd:lastTipIdx'
      };

      const loadCount = () => {
        const v = Number(localStorage.getItem(KEY.count) || '0');
        return Number.isFinite(v) && v >= 0 ? v : 0;
      };
      const saveCount = (v) => localStorage.setItem(KEY.count, String(v));
      const loadLastTip = () => {
        const v = Number(localStorage.getItem(KEY.lastTip) || '-1');
        return Number.isInteger(v) ? v : -1;
      };
      const saveLastTip = (i) => localStorage.setItem(KEY.lastTip, String(i));

      let count = loadCount();
      let currentTipIdx = loadLastTip();

      // ----- Tip Logic -----
      const randomIdx = (max, notEq = -1) => {
        if (max <= 1) return 0;
        let i = Math.floor(Math.random() * max);
        if (i === notEq) i = (i + 1) % max;
        return i;
      };

      const renderCount = () => { elCount.textContent = String(count); };
      const renderTip = () => {
        if (currentTipIdx < 0 || currentTipIdx >= TIPS.length) currentTipIdx = 0;
        elTip.textContent = 'â€¢ ' + TIPS[currentTipIdx];
        elTip.dataset.idx = String(currentTipIdx);
      };
      const nextTip = () => {
        currentTipIdx = randomIdx(TIPS.length, currentTipIdx);
        saveLastTip(currentTipIdx);
        renderTip();
      };

      // ----- Message Logic -----
      const makeMessage = () => {
        const to = elTo.value;
        const tone = elTone.value;
        const name = (elName.value || '').trim();
        const pool = TEMPLATES[tone] || TEMPLATES.light;
        const template = pool[randomIdx(pool.length)];
        const target = name || to;
        const body = template.replace('%%name%%', target);
        const suffix = '\n\nä¸–ç•Œè¦ªåˆ‡ãƒ‡ãƒ¼ã«å¯„ã›ã¦ã€‚å°ã•ãªè¦ªåˆ‡ã‚’å°‘ã—ãšã¤ğŸ¤';
        return body + suffix;
      };

      // ----- Confetti Animation -----
      const cnv = document.getElementById('confetti');
      const ctx = cnv.getContext('2d');
      let confettiTimer = 0;
      const fit = () => { cnv.width = innerWidth; cnv.height = innerHeight; };
      window.addEventListener('resize', fit, { passive: true });
      fit();
      const confetti = [];
      const spawnConfetti = (n = 80) => {
        for (let i = 0; i < n; i++) {
          confetti.push({
            x: Math.random() * cnv.width,
            y: -20 - Math.random() * 40,
            w: 6 + Math.random() * 6,
            h: 8 + Math.random() * 8,
            vy: 2 + Math.random() * 3,
            vx: -1 + Math.random() * 2,
            rot: Math.random() * Math.PI,
            vr: -0.2 + Math.random() * 0.4,
            col: Math.random() < 0.33 ? '#22c55e' : (Math.random() < 0.5 ? '#60a5fa' : '#f59e0b')
          });
        }
      };
      const step = () => {
        ctx.clearRect(0, 0, cnv.width, cnv.height);
        for (const p of confetti) {
          p.x += p.vx; p.y += p.vy; p.rot += p.vr;
        }
        for (let i = confetti.length - 1; i >= 0; i--) {
          if (confetti[i].y > cnv.height + 20) confetti.splice(i, 1);
        }
        for (const p of confetti) {
          ctx.save();
          ctx.translate(p.x, p.y);
          ctx.rotate(p.rot);
          ctx.fillStyle = p.col;
          ctx.fillRect(-p.w/2, -p.h/2, p.w, p.h);
          ctx.restore();
        }
        confettiTimer = requestAnimationFrame(step);
      };
      step();
      const celebrate = () => { spawnConfetti(100); };

      // ----- Events -----
      elAnother.addEventListener('click', nextTip);
      elDone.addEventListener('click', () => {
        count += 1; saveCount(count); renderCount(); celebrate();
      });
      elReset.addEventListener('click', () => {
        if (!confirm('ä»Šæ—¥ã®ã‚«ã‚¦ãƒ³ãƒˆã‚’0ã«ã—ã¾ã™ã€‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ')) return;
        count = 0; saveCount(count); renderCount();
      });
      elGen.addEventListener('click', () => { elMsg.value = makeMessage(); });
      elCopy.addEventListener('click', async () => {
        try {
          await navigator.clipboard.writeText(elMsg.value);
          elCopy.textContent = 'ã‚³ãƒ”ãƒ¼æ¸ˆã¿ï¼';
          setTimeout(() => (elCopy.textContent = 'ã‚³ãƒ”ãƒ¼'), 1200);
        } catch {
          alert('ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸ');
        }
      });
      elShare.addEventListener('click', async () => {
        const text = elMsg.value || makeMessage();
        if (navigator.share) {
          try { await navigator.share({ text }); } catch (e) { /* cancel */ }
        } else {
          try {
            await navigator.clipboard.writeText(text);
            alert('å…±æœ‰ã«æœªå¯¾å¿œã®ãŸã‚ã€ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸã€‚');
          } catch { alert('å…±æœ‰/ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸ'); }
        }
      });

      // ----- Init -----
      const boot = () => {
        renderCount();
        if (currentTipIdx < 0) {
          currentTipIdx = randomIdx(TIPS.length);
          saveLastTip(currentTipIdx);
        }
        renderTip();
        elMsg.value = makeMessage();
      };
      boot();
    })();
  </script>
</body>
</html>

