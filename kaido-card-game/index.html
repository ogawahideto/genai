<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ±Ÿæˆ¸è¡—é“æ—…è·¯ã‚«ãƒ¼ãƒ‰ã‚²ãƒ¼ãƒ </title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Georgia', serif;
            background: linear-gradient(135deg, #f4e4bc, #d4af37);
            min-height: 100vh;
            padding: 20px;
        }

        .game-container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .game-title {
            text-align: center;
            font-size: 2.5em;
            color: #8B4513;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .game-subtitle {
            text-align: center;
            font-size: 1.2em;
            color: #654321;
            margin-bottom: 30px;
        }

        .game-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
            padding: 15px;
            background: #f9f5dc;
            border-radius: 10px;
            border: 2px solid #8B4513;
        }

        .score, .current-road, .status {
            font-weight: bold;
            font-size: 1.1em;
            color: #8B4513;
        }

        .roads-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .road {
            background: #fff8dc;
            border: 3px solid #8B4513;
            border-radius: 15px;
            padding: 15px;
            transition: transform 0.3s ease;
        }

        .road:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }

        .road-title {
            text-align: center;
            font-size: 1.3em;
            font-weight: bold;
            color: #8B4513;
            margin-bottom: 15px;
            padding: 8px;
            background: linear-gradient(45deg, #daa520, #ffd700);
            border-radius: 8px;
        }

        .stations {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .station-card {
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            background: #fff;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-size: 0.95em;
            position: relative;
        }

        .station-card:hover {
            background: #fffacd;
            border-color: #ffd700;
            transform: scale(1.02);
        }

        .station-card.correct {
            background: #90EE90;
            border-color: #228B22;
            color: #006400;
        }

        .station-card.visited {
            background: #f0f0f0;
            border-color: #999;
            color: #666;
            cursor: not-allowed;
        }

        .station-card.error {
            background: #FFB6C1;
            border-color: #DC143C;
            color: #8B0000;
            animation: shake 0.5s ease-in-out;
        }


        .controls {
            text-align: center;
            margin-top: 30px;
        }

        .btn {
            padding: 12px 25px;
            font-size: 1.1em;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            margin: 0 10px;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: #8B4513;
            color: white;
        }

        .btn-primary:hover {
            background: #654321;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #daa520;
            color: white;
        }

        .btn-secondary:hover {
            background: #b8860b;
            transform: translateY(-2px);
        }

        .rules {
            background: #f9f5dc;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            border-left: 5px solid #8B4513;
        }

        .rules h3 {
            color: #8B4513;
            margin-bottom: 10px;
        }

        .rules ul {
            margin-left: 20px;
            color: #654321;
        }

        .completed-road {
            opacity: 0.7;
            background: #e8f5e8 !important;
        }

        .completed-road .road-title {
            background: linear-gradient(45deg, #90EE90, #98FB98);
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .victory-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 40px;
            border-radius: 20px;
            border: 5px solid #8B4513;
            text-align: center;
            z-index: 1000;
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.5);
            display: none;
        }

        .victory-message h2 {
            color: #8B4513;
            font-size: 2.5em;
            margin-bottom: 20px;
        }

        .victory-message p {
            font-size: 1.3em;
            color: #654321;
            margin-bottom: 30px;
        }

        @media (max-width: 768px) {
            .game-title {
                font-size: 2em;
            }
            
            .roads-container {
                grid-template-columns: 1fr;
            }
            
            .game-info {
                flex-direction: column;
                gap: 10px;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <!--
    AI Model: Claude Sonnet 4
    User Prompt: æ—¥æœ¬ã®æ—§è¡—é“ã‚’ä½¿ã£ãŸã‚«ãƒ¼ãƒ‰ã‚²ãƒ¼ãƒ ã‚’è€ƒãˆã¦ã€æ–°ã—ã„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œã‚Šã€HTMLã§å®Ÿè£…ã—ã¦ãã ã•ã„
    AI Approach: æ±Ÿæˆ¸æ™‚ä»£ã®5å¤§è¡—é“ï¼ˆæ±æµ·é“ã€ä¸­å±±é“ã€ç”²å·è¡—é“ã€æ—¥å…‰è¡—é“ã€å¥¥å·è¡—é“ï¼‰ã‚’ä½¿ã£ãŸã‚«ãƒ¼ãƒ‰ã‚²ãƒ¼ãƒ ã€‚ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¯æ­£ã—ã„é †åºã§å®¿å ´ç”ºã‚’è¨ªå•ã—ã¦è¡—é“ã‚’åˆ¶è¦‡ã™ã‚‹
    Implementation Intent: æ—¥æœ¬ã®æ­´å²ã¨æ–‡åŒ–ã‚’å­¦ã³ãªãŒã‚‰æ¥½ã—ã‚ã‚‹æ•™è‚²çš„ãªã‚«ãƒ¼ãƒ‰ã‚²ãƒ¼ãƒ ã€‚å®Ÿéš›ã®å®¿å ´ç”ºãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã—ã€æ±Ÿæˆ¸æ™‚ä»£ã®æ—…è·¯ã‚’ä½“é¨“ã§ãã‚‹
    -->

    <div class="game-container">
        <h1 class="game-title">ğŸ® æ±Ÿæˆ¸è¡—é“æ—…è·¯ ğŸ®</h1>
        <p class="game-subtitle">äº”å¤§è¡—é“ã‚’åˆ¶è¦‡ã›ã‚ˆï¼æ­£ã—ã„é †åºã§å®¿å ´ç”ºã‚’å·¡ã‚‹æ—…è·¯ã‚«ãƒ¼ãƒ‰ã‚²ãƒ¼ãƒ </p>

        <div class="game-info">
            <div class="score">å¾—ç‚¹: <span id="score">0</span></div>
            <div class="current-road">åˆ¶è¦‡æ¸ˆã¿: <span id="completed">0</span>/5è¡—é“</div>
            <div class="status">æ¬¡ã®å®¿å ´: <span id="next-station">å“å·å®¿</span></div>
        </div>

        <div class="roads-container" id="roads-container">
            <!-- è¡—é“ã¯JavaScriptã§å‹•çš„ç”Ÿæˆ -->
        </div>

        <div class="controls">
            <div style="margin-bottom: 15px;">
                <label for="difficulty" style="font-weight: bold; margin-right: 10px; color: #8B4513;">é›£æ˜“åº¦:</label>
                <select id="difficulty" onchange="changeDifficulty()" style="padding: 5px 10px; border-radius: 5px; border: 2px solid #8B4513;">
                    <option value="easy">ç°¡å˜ (6å®¿å ´)</option>
                    <option value="medium">æ™®é€š (8å®¿å ´)</option>
                    <option value="hard">å›°é›£ (10å®¿å ´)</option>
                </select>
            </div>
            <button class="btn btn-primary" onclick="resetGame()">ğŸ”„ ã‚²ãƒ¼ãƒ ãƒªã‚»ãƒƒãƒˆ</button>
            <button class="btn btn-secondary" onclick="showHint()">ğŸ’¡ ãƒ’ãƒ³ãƒˆ</button>
            <button class="btn btn-secondary" onclick="showRules()">ğŸ“š è©³ç´°ãƒ«ãƒ¼ãƒ«</button>
        </div>

        <div class="rules">
            <h3>ğŸ¯ ã‚²ãƒ¼ãƒ ãƒ«ãƒ¼ãƒ«</h3>
            <ul>
                <li>æ±Ÿæˆ¸æ™‚ä»£ã®æ—…äººã¨ãªã‚Šã€5ã¤ã®è¡—é“ã‚’é †ç•ªã«å·¡ã‚Šã¾ã™</li>
                <li>å„è¡—é“ã®å®¿å ´ç”ºã‚«ãƒ¼ãƒ‰ã¯<strong>ã‚·ãƒ£ãƒƒãƒ•ãƒ«</strong>ã•ã‚Œã¦ã„ã¾ã™</li>
                <li>æ±Ÿæˆ¸ã‹ã‚‰é †ç•ªã«<strong>æ­£ã—ã„é †åº</strong>ã§ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãã ã•ã„</li>
                <li>æ­£è§£ã ã¨ +150ç‚¹ã€é–“é•ã£ãŸé †åºã ã¨ -50ç‚¹ã§ã™</li>
                <li>å„è¡—é“å®Œäº†ã§+500ç‚¹ãƒœãƒ¼ãƒŠã‚¹ï¼å…¨è¡—é“åˆ¶è¦‡ã§å‹åˆ©ã§ã™</li>
                <li>é›£æ˜“åº¦ã§å®¿å ´æ•°ã¨ã‚·ãƒ£ãƒƒãƒ•ãƒ«åº¦ãŒå¤‰ã‚ã‚Šã¾ã™</li>
            </ul>
        </div>
    </div>

    <div class="victory-message" id="victory-message">
        <h2>ğŸ‰ è¡—é“åˆ¶è¦‡é”æˆï¼ ğŸ‰</h2>
        <p>ãŠç–²ã‚Œã•ã¾ã§ã—ãŸï¼<br>æ±Ÿæˆ¸æ™‚ä»£ã®è¡—é“æ—…è·¯ã‚’è¦‹äº‹ã«åˆ¶è¦‡ã•ã‚Œã¾ã—ãŸã€‚</p>
        <p>æœ€çµ‚å¾—ç‚¹: <span id="final-score">0</span>ç‚¹</p>
        <button class="btn btn-primary" onclick="resetGame(); hideVictory();">ã‚‚ã†ä¸€åº¦æŒ‘æˆ¦</button>
    </div>

    <script>
        // è¡—é“ãƒ‡ãƒ¼ã‚¿ï¼ˆæ±Ÿæˆ¸ã‹ã‚‰é †ç•ªï¼‰
        const ROADS_DATA = {
            'æ±æµ·é“': ['æ±Ÿæˆ¸', 'å“å·', 'å·å´', 'ç¥å¥ˆå·', 'ä¿åœŸãƒ¶è°·', 'æˆ¸å¡š', 'è—¤æ²¢', 'å¹³å¡š', 'å°ç”°åŸ', 'ç®±æ ¹', 'ä¸‰å³¶', 'æ²¼æ´¥', 'å‰åŸ', 'åºœä¸­', 'ä¸¸å­', 'å²¡éƒ¨', 'å³¶ç”°', 'æ›å·', 'æµœæ¾', 'èˆé˜ª', 'æ–°å±…', 'å‰ç”°', 'å¾¡æ²¹', 'å²¡å´', 'çŸ¥ç«‹', 'å®®', 'æ¡‘å', 'å››æ—¥å¸‚', 'äº€å±±', 'é–¢', 'åœŸå±±', 'æ°´å£', 'çŸ³éƒ¨', 'è‰æ´¥', 'å¤§æ´¥', 'äº¬éƒ½'],
            'ä¸­å±±é“': ['æ±Ÿæˆ¸', 'æ¿æ©‹', 'è•¨', 'æµ¦å’Œ', 'å¤§å®®', 'ä¸Šå°¾', 'æ¡¶å·', 'é´»å·£', 'ç†Šè°·', 'æ·±è°·', 'æœ¬åº„', 'æ–°ç”º', 'å€‰è³€é‡', 'é«˜å´', 'æ¿é¼»', 'å®‰ä¸­', 'æ¾äº•ç”°', 'å‚æœ¬', 'è»½äº•æ²¢', 'æ²“æ›', 'è¿½åˆ†', 'å°ç”°äº•', 'å²©æ‘ç”°', 'å¡©åç”°', 'å…«å¹¡', 'æœ›æœˆ', 'è•ªæœ¨', 'èŒ‚ç”°äº•', 'èŠ¦ç”°', 'é•·çªª', 'å’Œç”°', 'ä¸‹è«è¨ª', 'å¡©å°»', 'æ´—é¦¬', 'æœ¬å±±', 'è´„å·', 'å¥ˆè‰¯äº•', 'è–®åŸ', 'å®®ãƒè¶Š', 'ç¦å³¶', 'ä¸Šæ¾', 'é ˆåŸ', 'é‡å°»', 'ä¸‰ç•™é‡', 'å¦»ç± ', 'é¦¬ç± ', 'è½åˆ', 'ä¸­æ´¥å·', 'å¤§äº•', 'å¤§æ¹«', 'ç´°ä¹…æ‰‹', 'å¾¡å¶½', 'ä¼è¦‹', 'å¤ªç”°', 'éµœæ²¼', 'åŠ ç´', 'æ²³æ¸¡', 'ç¾æ±Ÿå¯º', 'èµ¤å‚', 'å‚äº•', 'é–¢ãƒ¶åŸ', 'ä»Šé ˆ', 'æŸåŸ', 'é†’äº•', 'ç•ªå ´', 'é³¥å±…æœ¬', 'é«˜å®®', 'æ„›çŸ¥å·', 'æ­¦ä½', 'å®ˆå±±', 'è‰æ´¥', 'å¤§æ´¥', 'äº¬éƒ½'],
            'ç”²å·è¡—é“': ['æ±Ÿæˆ¸', 'å†…è—¤æ–°å®¿', 'ä¸‹é«˜äº•æˆ¸', 'ä¸Šé«˜äº•æˆ¸', 'å¸ƒç”°', 'åºœä¸­', 'æ—¥é‡', 'å…«ç‹å­', 'é§’æœ¨é‡', 'å°ä»', 'å°åŸ', 'ä¸ç€¬', 'å‰é‡', 'é–¢é‡', 'ä¸Šé‡åŸ', 'é¶´å·', 'é‡ç”°å°»', 'çŠ¬ç›®', 'ä¸‹é³¥æ²¢', 'ä¸Šé³¥æ²¢', 'çŒ¿æ©‹', 'é§’æ©‹', 'å¤§æœˆ', 'ä¸‹èŠ±å’²', 'ä¸ŠèŠ±å’²', 'ä¸‹åˆç‹©', 'ä¸­åˆç‹©', 'ç™½é‡', 'é˜¿å¼¥é™€æµ·é“', 'é»’é‡ç”°', 'é§’é£¼', 'é¶´ç€¬', 'å‹æ²¼', 'æ —åŸ', 'çŸ³å’Œ', 'ç”²åºœ'],
            'æ—¥å…‰è¡—é“': ['æ±Ÿæˆ¸', 'åƒä½', 'è‰åŠ ', 'è¶Šãƒ¶è°·', 'ç²•å£', 'æ‰æˆ¸', 'å¹¸æ‰‹', 'æ —æ©‹', 'ä¸­ç”°', 'å¤æ²³', 'é‡æœ¨', 'é–“ã€…ç”°', 'å°å±±', 'æ–°ç”°', 'å°é‡‘äº•', 'çŸ³æ©‹', 'é›€å®®', 'å®‡éƒ½å®®', 'å¾³æ¬¡éƒ', 'å¤§æ²¢', 'ä»Šå¸‚', 'é‰¢çŸ³', 'æ—¥å…‰'],
            'å¥¥å·è¡—é“': ['æ±Ÿæˆ¸', 'åƒä½', 'è‰åŠ ', 'è¶Šãƒ¶è°·', 'ç²•å£', 'æ‰æˆ¸', 'å¹¸æ‰‹', 'æ —æ©‹', 'ä¸­ç”°', 'å¤æ²³', 'é‡æœ¨', 'é–“ã€…ç”°', 'å°å±±', 'æ–°ç”°', 'å°é‡‘äº•', 'çŸ³æ©‹', 'é›€å®®', 'å®‡éƒ½å®®', 'ç™½æ²¢', 'æ°å®¶', 'å–œé€£å·', 'ä½ä¹…å±±', 'å¤§ç”°åŸ', 'é‹æ›', 'è¶Šå €', 'èŠ¦é‡', 'ç™½å‚', 'ç™½æ²³']
        };

        // ã‚²ãƒ¼ãƒ çŠ¶æ…‹
        let gameState = {
            score: 0,
            selectedRoad: null,
            selectedStations: {},
            completedRoads: new Set(),
            roadProgress: {},
            difficultyLevel: 'easy',
            maxStationsPerRoad: 8
        };

        // é›£æ˜“åº¦è¨­å®š
        const DIFFICULTY_SETTINGS = {
            easy: { maxStations: 6, shuffleIntensity: 0.3 },
            medium: { maxStations: 8, shuffleIntensity: 0.6 },
            hard: { maxStations: 10, shuffleIntensity: 1.0 }
        };

        // é…åˆ—ã‚’ã‚·ãƒ£ãƒƒãƒ•ãƒ«ã™ã‚‹é–¢æ•°
        function shuffleArray(array, intensity = 1.0) {
            const shuffled = [...array];
            const shuffleCount = Math.floor(array.length * intensity);
            
            for (let i = 0; i < shuffleCount; i++) {
                const j = Math.floor(Math.random() * shuffled.length);
                const k = Math.floor(Math.random() * shuffled.length);
                [shuffled[j], shuffled[k]] = [shuffled[k], shuffled[j]];
            }
            return shuffled;
        }

        // ã‚²ãƒ¼ãƒ åˆæœŸåŒ–
        function initGame() {
            const difficulty = DIFFICULTY_SETTINGS[gameState.difficultyLevel];
            
            gameState = {
                ...gameState,
                score: 0,
                selectedRoad: null,
                selectedStations: {},
                completedRoads: new Set(),
                roadProgress: {},
                maxStationsPerRoad: difficulty.maxStations
            };
            
            // å„è¡—é“ã®é€²è¡ŒçŠ¶æ³ã¨é¸æŠçŠ¶æ³ã‚’åˆæœŸåŒ–
            Object.keys(ROADS_DATA).forEach(road => {
                gameState.roadProgress[road] = 0;
                gameState.selectedStations[road] = [];
            });
            
            renderRoads();
            updateGameInfo();
        }

        // è¡—é“è¡¨ç¤º
        function renderRoads() {
            const container = document.getElementById('roads-container');
            container.innerHTML = '';
            const difficulty = DIFFICULTY_SETTINGS[gameState.difficultyLevel];

            Object.entries(ROADS_DATA).forEach(([roadName, stations]) => {
                const roadDiv = document.createElement('div');
                roadDiv.className = `road ${gameState.completedRoads.has(roadName) ? 'completed-road' : ''}`;

                const titleDiv = document.createElement('div');
                titleDiv.className = 'road-title';
                titleDiv.textContent = `${roadName} (${gameState.roadProgress[roadName]}/${gameState.maxStationsPerRoad}å®Œäº†)`;
                roadDiv.appendChild(titleDiv);

                const stationsDiv = document.createElement('div');
                stationsDiv.className = 'stations';

                // æŒ‡å®šã•ã‚ŒãŸæ•°ã®å®¿å ´ç”ºã‚’å–å¾—ã—ã¦ã‚·ãƒ£ãƒƒãƒ•ãƒ«
                const gameStations = stations.slice(0, gameState.maxStationsPerRoad);
                const shuffledStations = shuffleArray(gameStations, difficulty.shuffleIntensity);
                
                shuffledStations.forEach((station, displayIndex) => {
                    const stationDiv = document.createElement('div');
                    stationDiv.className = 'station-card';
                    
                    const originalIndex = stations.indexOf(station);
                    const isSelected = gameState.selectedStations[roadName].includes(station);
                    const selectionOrder = gameState.selectedStations[roadName].indexOf(station) + 1;
                    
                    // çŠ¶æ…‹ã«å¿œã˜ã¦ã‚¯ãƒ©ã‚¹ã‚’è¨­å®š
                    if (isSelected) {
                        const correctIndex = gameState.selectedStations[roadName].indexOf(station);
                        const isCorrectOrder = gameState.selectedStations[roadName].slice(0, correctIndex + 1)
                            .every((s, i) => stations.indexOf(s) <= stations.indexOf(gameState.selectedStations[roadName][i])) &&
                            stations.indexOf(station) === stations.indexOf(gameState.selectedStations[roadName][correctIndex]);
                        
                        stationDiv.classList.add(isCorrectOrder ? 'correct' : 'error');
                    }
                    
                    stationDiv.innerHTML = `
                        ${station}${station === 'æ±Ÿæˆ¸' || station === 'äº¬éƒ½' ? '' : 'å®¿'}
                        ${isSelected ? `<div style="position: absolute; top: 2px; right: 5px; font-size: 0.8em; font-weight: bold; color: #8B4513;">${selectionOrder}</div>` : ''}
                    `;
                    
                    stationDiv.onclick = () => selectStation(roadName, station);
                    stationsDiv.appendChild(stationDiv);
                });

                // ãƒªã‚»ãƒƒãƒˆãƒœã‚¿ãƒ³
                const resetBtn = document.createElement('button');
                resetBtn.textContent = 'ğŸ”„ ã“ã®è¡—é“ã‚’ãƒªã‚»ãƒƒãƒˆ';
                resetBtn.className = 'btn btn-secondary';
                resetBtn.style.width = '100%';
                resetBtn.style.marginTop = '10px';
                resetBtn.onclick = () => resetRoad(roadName);
                roadDiv.appendChild(resetBtn);

                roadDiv.appendChild(stationsDiv);
                container.appendChild(roadDiv);
            });
        }

        // å®¿å ´é¸æŠå‡¦ç†
        function selectStation(roadName, stationName) {
            const stations = ROADS_DATA[roadName];
            
            // æ—¢ã«é¸æŠæ¸ˆã¿ã®å®¿å ´ã¯å†é¸æŠä¸å¯
            if (gameState.selectedStations[roadName].includes(stationName)) {
                return;
            }

            // å®¿å ´ã‚’é¸æŠãƒªã‚¹ãƒˆã«è¿½åŠ 
            gameState.selectedStations[roadName].push(stationName);
            
            // æ­£è§£åˆ¤å®šï¼šé¸æŠã•ã‚ŒãŸå®¿å ´ãŒæ­£ã—ã„é †åºã‹ãƒã‚§ãƒƒã‚¯
            const selectedStations = gameState.selectedStations[roadName];
            const isCorrectOrder = checkStationOrder(roadName, selectedStations);
            
            if (isCorrectOrder) {
                // æ­£è§£
                gameState.score += 150;
                gameState.roadProgress[roadName] = selectedStations.length;
                
                // è¡—é“å®Œæˆãƒã‚§ãƒƒã‚¯
                if (selectedStations.length >= gameState.maxStationsPerRoad) {
                    gameState.completedRoads.add(roadName);
                    gameState.score += 500; // ãƒœãƒ¼ãƒŠã‚¹ç‚¹
                    
                    setTimeout(() => {
                        alert(`ğŸ‰ ${roadName}åˆ¶è¦‡ï¼ãƒœãƒ¼ãƒŠã‚¹500ç‚¹ç²å¾—ï¼`);
                    }, 500);
                }
            } else {
                // ä¸æ­£è§£
                gameState.score -= 50;
            }
            
            updateGameInfo();
            renderRoads();
            
            // å…¨è¡—é“åˆ¶è¦‡åˆ¤å®š
            if (gameState.completedRoads.size === 5) {
                setTimeout(() => {
                    showVictory();
                }, 1000);
            }
        }

        // å®¿å ´é †åºãƒã‚§ãƒƒã‚¯
        function checkStationOrder(roadName, selectedStations) {
            const stations = ROADS_DATA[roadName];
            
            for (let i = 0; i < selectedStations.length; i++) {
                for (let j = i + 1; j < selectedStations.length; j++) {
                    const indexI = stations.indexOf(selectedStations[i]);
                    const indexJ = stations.indexOf(selectedStations[j]);
                    
                    // å¾Œã‹ã‚‰é¸æŠã—ãŸå®¿å ´ãŒå‰ã®é †åºã«ã‚ã‚‹å ´åˆã¯é–“é•ã„
                    if (indexI > indexJ) {
                        return false;
                    }
                }
            }
            return true;
        }

        // è¡—é“ãƒªã‚»ãƒƒãƒˆ
        function resetRoad(roadName) {
            gameState.selectedStations[roadName] = [];
            gameState.roadProgress[roadName] = 0;
            gameState.completedRoads.delete(roadName);
            renderRoads();
            updateGameInfo();
        }

        // ã‚²ãƒ¼ãƒ æƒ…å ±æ›´æ–°
        function updateGameInfo() {
            document.getElementById('score').textContent = gameState.score;
            document.getElementById('completed').textContent = gameState.completedRoads.size;
            
            // é€²è¡Œä¸­ã®è¡—é“æƒ…å ±ã‚’è¡¨ç¤º
            let statusText = '';
            const inProgressRoads = Object.keys(ROADS_DATA).filter(road => 
                !gameState.completedRoads.has(road) && gameState.selectedStations[road].length < gameState.maxStationsPerRoad
            );
            
            if (inProgressRoads.length > 0) {
                const roadName = inProgressRoads[0];
                const progress = gameState.selectedStations[roadName].length;
                statusText = `${roadName} (${progress}/${gameState.maxStationsPerRoad})`;
            } else if (gameState.completedRoads.size === 5) {
                statusText = 'å…¨è¡—é“åˆ¶è¦‡ï¼';
            } else {
                statusText = 'è¡—é“ã‚’é¸æŠã—ã¦ãã ã•ã„';
            }
            
            document.getElementById('next-station').textContent = statusText;
        }

        // ãƒ’ãƒ³ãƒˆè¡¨ç¤º
        function showHint() {
            let hintMessage = 'ğŸ’¡ ãƒ’ãƒ³ãƒˆ:\n\n';
            
            for (const [roadName, stations] of Object.entries(ROADS_DATA)) {
                if (gameState.completedRoads.has(roadName)) {
                    hintMessage += `${roadName}: âœ… åˆ¶è¦‡æ¸ˆã¿\n`;
                } else {
                    const selectedCount = gameState.selectedStations[roadName].length;
                    const nextIndex = selectedCount;
                    
                    if (nextIndex < gameState.maxStationsPerRoad) {
                        const nextStation = stations[nextIndex];
                        hintMessage += `${roadName}: æ¬¡ã¯ã€Œ${nextStation}${nextStation === 'æ±Ÿæˆ¸' || nextStation === 'äº¬éƒ½' ? '' : 'å®¿'}ã€ã§ã™ (${selectedCount}/${gameState.maxStationsPerRoad}å®Œäº†)\n`;
                    }
                }
            }
            
            alert(hintMessage);
        }

        // å‹åˆ©ç”»é¢è¡¨ç¤º
        function showVictory() {
            document.getElementById('final-score').textContent = gameState.score;
            document.getElementById('victory-message').style.display = 'block';
        }

        // å‹åˆ©ç”»é¢éè¡¨ç¤º
        function hideVictory() {
            document.getElementById('victory-message').style.display = 'none';
        }

        // é›£æ˜“åº¦å¤‰æ›´
        function changeDifficulty() {
            const difficulty = document.getElementById('difficulty').value;
            gameState.difficultyLevel = difficulty;
            initGame();
        }

        // è©³ç´°ãƒ«ãƒ¼ãƒ«è¡¨ç¤º
        function showRules() {
            const rulesText = `
ğŸ“š æ±Ÿæˆ¸è¡—é“æ—…è·¯ã‚«ãƒ¼ãƒ‰ã‚²ãƒ¼ãƒ  - è©³ç´°ãƒ«ãƒ¼ãƒ«

ğŸ¯ ã‚²ãƒ¼ãƒ ã®ç›®çš„:
æ±Ÿæˆ¸æ™‚ä»£ã®5å¤§è¡—é“ã™ã¹ã¦ã‚’åˆ¶è¦‡ã™ã‚‹ã“ã¨ã§ã™ã€‚

ğŸ® è¡—é“ã«ã¤ã„ã¦:
ãƒ»æ±æµ·é“: æ±Ÿæˆ¸ã€œäº¬éƒ½ã®å¤ªå¹³æ´‹ãƒ«ãƒ¼ãƒˆ
ãƒ»ä¸­å±±é“: æ±Ÿæˆ¸ã€œäº¬éƒ½ã®å±±é–“ãƒ«ãƒ¼ãƒˆ  
ãƒ»ç”²å·è¡—é“: æ±Ÿæˆ¸ã€œç”²åºœã¸ã®è¥¿æ–¹ãƒ«ãƒ¼ãƒˆ
ãƒ»æ—¥å…‰è¡—é“: æ±Ÿæˆ¸ã€œæ—¥å…‰ã¸ã®åŒ—æ–¹ãƒ«ãƒ¼ãƒˆ
ãƒ»å¥¥å·è¡—é“: æ±Ÿæˆ¸ã‹ã‚‰æ±åŒ—ã¸ã®é•·è·é›¢ãƒ«ãƒ¼ãƒˆ

ğŸ® éŠã³æ–¹:
1. å„è¡—é“ã®å®¿å ´ç”ºã‚«ãƒ¼ãƒ‰ãŒã‚·ãƒ£ãƒƒãƒ•ãƒ«ã•ã‚Œã¦è¡¨ç¤ºã•ã‚Œã¾ã™
2. æ±Ÿæˆ¸ã‹ã‚‰é †ç•ªã«ã€æ­£ã—ã„é †åºã§å®¿å ´ç”ºã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãã ã•ã„
3. é–“é•ã£ãŸé †åºã§é¸æŠã™ã‚‹ã¨æ¸›ç‚¹ã•ã‚Œã¾ã™ãŒã€ã‚²ãƒ¼ãƒ ç¶šè¡Œå¯èƒ½ã§ã™
4. è¡—é“ãƒªã‚»ãƒƒãƒˆãƒœã‚¿ãƒ³ã§å€‹åˆ¥ã®è¡—é“ã‚’ã‚„ã‚Šç›´ã›ã¾ã™

âš”ï¸ é›£æ˜“åº¦:
ãƒ»ç°¡å˜: 6å®¿å ´ã€è»½ã„ã‚·ãƒ£ãƒƒãƒ•ãƒ«
ãƒ»æ™®é€š: 8å®¿å ´ã€ä¸­ç¨‹åº¦ã‚·ãƒ£ãƒƒãƒ•ãƒ«
ãƒ»å›°é›£: 10å®¿å ´ã€å®Œå…¨ã‚·ãƒ£ãƒƒãƒ•ãƒ«

ğŸ† å¾—ç‚¹ã‚·ã‚¹ãƒ†ãƒ :
ãƒ»æ­£è§£: +150ç‚¹
ãƒ»é–“é•ã„: -50ç‚¹  
ãƒ»è¡—é“åˆ¶è¦‡: +500ç‚¹ãƒœãƒ¼ãƒŠã‚¹
ãƒ»å…¨è¡—é“åˆ¶è¦‡ã§å‹åˆ©ï¼

ğŸ’¡ ã‚«ãƒ¼ãƒ‰ã®è¦‹æ–¹:
ãƒ»å³ä¸Šã®æ•°å­—: ã‚ãªãŸã®é¸æŠé †åº
ãƒ»ç·‘è‰²: æ­£ã—ã„é †åºã§é¸æŠæ¸ˆã¿
ãƒ»èµ¤è‰²: é–“é•ã£ãŸé †åºã§é¸æŠ
ãƒ»å®¿å ´ç”ºåã®ã¿è¡¨ç¤ºï¼ˆé †åºã¯æ¨ç†ã—ã¦ãã ã•ã„ï¼ï¼‰
            `;
            alert(rulesText);
        }

        // ã‚²ãƒ¼ãƒ ãƒªã‚»ãƒƒãƒˆ
        function resetGame() {
            initGame();
        }

        // ã‚²ãƒ¼ãƒ é–‹å§‹
        initGame();
    </script>
</body>
</html>